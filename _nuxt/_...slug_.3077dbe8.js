import{_ as G}from"./tag.vue.dcf28140.js";import{_ as K}from"./page.vue.a4b99219.js";import{a as k,k as $,s as P,o as _,b as m,y as n,F as T,x as Q,aa as V,ab as z,h as Y,u as d,B as g,z as D,A as F,i as S,c as j,w as A,f,ad as Z,C as y,ae as tt,j as et,a1 as nt,J as st,X as ot,a3 as ct,H as at,R as q,v as E}from"./entry.0d4d7c07.js";/* empty css                 */import rt from"./ContentRenderer.0b91fb0f.js";import{u as O,q as R}from"./query.c3a094c0.js";import{r as L,g as it}from"./data_type.bda3f72e.js";import"./state.cef56aeb.js";import"./ContentRendererMarkdown.8eae5b28.js";import"./utils.2861b96a.js";const lt=k({__name:"comment",setup(e){const t=T(),a=$();return P(()=>{const s=document.createElement("script"),u=t.public.comment;for(const p in u)s.setAttribute(p.replace("_","-"),String(u[p]));a.value&&a.value.appendChild(s)}),(s,u)=>(_(),m("div",null,[n("section",{class:"w-full",ref_key:"self",ref:a},null,512)]))}}),_t=e=>(D("data-v-88742a70"),e=e(),F(),e),dt={class:"toc"},ut=_t(()=>n("header",{class:"toc-header"},[n("h3",{class:"text-xl font-bold"},"Table of contents")],-1)),pt={class:"toc-links"},mt=["id","onClick"],ft=["href"],ht=k({__name:"toc",props:{links:null,active_toc_id:null},setup(e){const t=e,a=$(),s=r=>`toc-${r}`;Q(()=>t.active_toc_id,()=>{a.value=t.active_toc_id});const u=r=>r.map(o=>{let i=[o];if(o.children){let v=u(o.children);i=[o,...v]}return i}).flat(1),p=r=>{const o={};return o[`_${r.depth}`]=!0,o},h=r=>{a.value=r.id};return(r,o)=>(_(),m("nav",dt,[ut,n("ul",pt,[(_(!0),m(V,null,z(u(e.links),i=>(_(),m("li",{key:i.id,id:s(i.id),onClick:v=>h(i),class:Y(["toc-link",{...p(i),"font-bold":i.id===d(a)}])},[n("a",{href:`#${i.id}`},g(i.text),9,ft)],10,mt))),128))])]))}}),vt=S(ht,[["__scopeId","data-v-88742a70"]]),xt={class:"prev-next-cont"},gt={class:"link-item prev"},$t={class:"link-item next"},yt=k({__name:"prev_next",props:{prefix:null,prev:null,next:null},setup(e){var p,h;const t=e,a=(r,o)=>o?r?o.startsWith("/")?r+o:r+"/"+o:o:"",s=a(t.prefix,(p=t.prev)==null?void 0:p._path),u=a(t.prefix,(h=t.next)==null?void 0:h._path);return(r,o)=>{const i=et;return _(),m("ul",xt,[n("li",gt,[e.prev?(_(),j(i,{key:0,to:d(s)},{default:A(()=>[f(d(Z),{class:"icon stroke"}),n("span",null,g(e.prev.title),1)]),_:1},8,["to"])):y("",!0)]),n("li",$t,[e.next?(_(),j(i,{key:0,to:d(u)},{default:A(()=>[n("span",null,g(e.next.title),1),f(d(tt),{class:"icon stroke"})]),_:1},8,["to"])):y("",!0)])])}}}),kt=S(yt,[["__scopeId","data-v-3f6c87c4"]]),I=e=>(D("data-v-90392af7"),e=e(),F(),e),bt={class:"article-main"},wt={class:"article-header"},Ct={class:"mb-1 heading"},It={key:0,class:"mb-1 supporting"},At={key:1,class:"flex-wrap pb-0 article-tags"},St=I(()=>n("p",{class:"pt-1 font-mono text-sm font-thin text-slate-400"},"tags:",-1)),Bt={key:2,class:"flex-wrap mt-0 mb-1 article-tags"},Nt=I(()=>n("p",{class:"pt-1 font-mono text-sm font-thin text-slate-400"},"page:",-1)),jt={class:"font-mono text-sm font-thin text-slate-400"},qt=I(()=>n("hr",null,null,-1)),Et={class:"article-section"},Ot={class:"aside"},Rt={class:"article page"},Lt=I(()=>n("p",null,"No content found.",-1)),Pt=k({__name:"post",props:{article:null,prev:null,next:null,prefix:null},setup(e){var C;const t=e,a=/\d{4}-[01]{1}\d{1}-[0-3]{1}\d{1}/,s=t.prev??void 0,u=t.next??void 0;if(!a.test(t.article.date))throw nt({statusCode:400,statusMessage:`invalid date string: ${t.article.date}`});const p=(C=t.article.date.match(a))==null?void 0:C.at(0);st({title:`${T().public.name} - ${t.article.title}`,meta:[{hid:"description",name:"description",content:t.article.description}]});const r=c=>{if(!c.children)return[];let l=[];for(const x of c.children){if(x.type==="text"){l=[...l,x.value];continue}l=[...l,...r(x)]}return l},o=["h1","h2","h3","h4","h5"],i=t.article.body.children.filter(c=>o.indexOf(c.tag??"")>=0).map(c=>{var l;return{id:(l=c.props)==null?void 0:l.id,depth:o.indexOf(c.tag??"")+1,text:r(c).join("")}}),v=$(),b=$(),w=$(null),B=ot({root:b.value,threshold:.5});return P(()=>{w.value=new IntersectionObserver(c=>{c.forEach(l=>{const x=l.target.getAttribute("id");l.isIntersecting&&(v.value=x)})},B),document.querySelectorAll([1,2,3,4,5].map(c=>`.nuxt-content h${c}[id]`).join(", ")).forEach(c=>{var l;(l=w.value)==null||l.observe(c)})}),ct(()=>{var c;(c=w.value)==null||c.disconnect()}),(c,l)=>{var N;const x=G,H=K,M=vt,W=rt,J=kt;return _(),m("div",bt,[n("div",null,[n("header",wt,[n("h1",Ct,g(t.article.title),1),e.article.description?(_(),m("p",It,g(t.article.description),1)):y("",!0),(N=t.article.tags)!=null&&N.length?(_(),m("ul",At,[St,(_(!0),m(V,null,z(t.article.tags,(U,X)=>(_(),m("div",{key:X},[f(x,{tag:U,do_select:!0},null,8,["tag"])]))),128))])):y("",!0),e.article.page?(_(),m("ul",Bt,[Nt,f(H,{page:e.article.page,do_select:!0},null,8,["page"])])):y("",!0),n("p",jt,"created at: "+g(d(p)),1)])]),qt,n("div",null,[n("section",Et,[n("aside",Ot,[f(M,{class:"toc",links:d(i),active_toc_id:d(v)},null,8,["links","active_toc_id"])]),n("article",Rt,[f(W,{class:"nuxt-content",value:t.article,ref_key:"content",ref:b},{empty:A(()=>[Lt]),_:1},8,["value"])])]),f(J,{prev:d(s),next:d(u),prefix:e.prefix},null,8,["prev","next","prefix"])])])}}}),Tt=S(Pt,[["__scopeId","data-v-90392af7"]]),Vt={id:"main"},Kt=k({__name:"[...slug]",async setup(e){let t,a,{path:s}=at();const u="/"+(s.split("/").at(1)??"");s="/"+s.split("/").slice(2).join("/"),s.endsWith("/")&&(s=s.slice(0,-1));const p=it(),{data:h}=([t,a]=q(()=>O(`selected_data_${s}`,()=>R(p).where({_path:s}).findOne())),t=await t,a(),t),r=L(h),{data:o}=([t,a]=q(()=>O(`selected_surround_${s}`,()=>R(p).only(["_path","title","description","date"]).findSurround(s))),t=await t,a(),t),i=L(o),v=E(()=>i.value[0]),b=E(()=>i.value[-1]);return(w,B)=>{const C=Tt,c=lt;return _(),m("main",Vt,[f(C,{article:d(r),prev:d(v),next:d(b),prefix:u},null,8,["article","prev","next"]),f(c)])}}});export{Kt as default};
