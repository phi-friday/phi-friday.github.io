const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./tX7FzPKt.js","./entry.4uPfcvK_.css","./BjEuvITW.js","./Ln2_kbYg.js","./Dp5qeDTI.js","./BqB4qWRx.js","./DV1cNU_M.js","./ey_FERa2.js","./header.Bvq2yFZ7.css","./Dhj-axHl.js","./body.BtuWHAZE.css","./FX5lqIGh.js","./CMf-J_pd.js","./footer.Dsvu2t9t.css","./CQKQ2h2t.js","./bnAwn7tz.js","./DcrymwDn.js"])))=>i.map(i=>d[i]);
import{d as P,u as S,c as z,a as V,r as B,w as D,b as I,e as v,f as h,g as T,h as b,i as s,j as $,k as j,o as f,l as a,_ as i,m as q}from"./tX7FzPKt.js";import{_ as M}from"./Ln2_kbYg.js";import{p as H,v as N}from"./Dp5qeDTI.js";import{g as W}from"./BqB4qWRx.js";import{u as F,q as C}from"./DV1cNU_M.js";const x=P({id:"current_url",state:()=>({route_path:null}),getters:{path:t=>H(t.route_path||""),prefix:t=>{var e;return"/"+(((e=t.route_path)==null?void 0:e.split("/").at(1))??"")}},actions:{sync_route(){const{path:t}=S();this.route_path=t},validate_url(t){N(t,this.path)}}});function U(t,e=500){if(!t)throw z({statusCode:Math.floor(e),statusMessage:`invaild article type: ${typeof t}`});return t}const G=/\d{4}-[01]{1}\d{1}-[0-3]{1}\d{1}/,J=t=>{var e;return t=(e=t.match(G))==null?void 0:e.at(0)},y=["h1","h2","h3","h4","h5"],E=(t,e)=>e?(e.endsWith("/")||(e=e+"/"),t?e.startsWith("/")?t+e:t+"/"+e:e):"",O=t=>t.map(e=>{let n=[e];if(e.children){const r=O(e.children);n=[e,...r]}return n}).flat(1),w=t=>{if(!t.children)return[];let e=[];for(const n of t.children){if(n.type==="text"){e=[...e,n.value];continue}e=[...e,...w(n)]}return e},K=P({id:"current_article",state:()=>({nullable_article:null,prev:null,next:null,active_toc_ids:new Set}),getters:{article:t=>U(t.nullable_article),date:t=>{var e;return J(((e=t.nullable_article)==null?void 0:e.date)||"")},title:t=>{var e;return((e=t.nullable_article)==null?void 0:e.title)||""},tags:t=>{var e;return((e=t.nullable_article)==null?void 0:e.tags)||[]},description:t=>{var e;return((e=t.nullable_article)==null?void 0:e.description)||""},prev_path:t=>{var n;const e=x();return E(e.prefix,(n=t.prev)==null?void 0:n._path)},next_path:t=>{var n;const e=x();return E(e.prefix,(n=t.next)==null?void 0:n._path)},toc_tags:()=>y,toc_links:t=>{var e;return((e=t.nullable_article)==null?void 0:e.body.children.filter(n=>y.indexOf(n.tag??"")>=0).map(n=>{var r;return{id:(r=n.props)==null?void 0:r.id,depth:y.indexOf(n.tag??"")+1,text:w(n).join("")}}))??[]},active_toc_ids_array:t=>[...t.active_toc_ids],flatten_toc_links:()=>O},actions:{set_article(t){this.nullable_article=t||null,this.active_toc_ids.clear()},set_prev(t){this.prev=t||null},set_next(t){this.next=t||null},sync_article(t){this.set_article(t==null?void 0:t.article)},sync_surround(t){var e,n;this.set_prev((e=t==null?void 0:t.surround)==null?void 0:e[0]),this.set_next((n=t==null?void 0:t.surround)==null?void 0:n[1])},set_active_toc_id(t){this.active_toc_ids.clear(),this.active_toc_ids.add(t.id)}}}),Q=a(()=>i(()=>import("./tX7FzPKt.js").then(t=>t.aB),__vite__mapDeps([0,1]),import.meta.url).then(t=>t.default||t)),X=a(()=>i(()=>import("./BjEuvITW.js"),__vite__mapDeps([2,0,1,3,4,5,6,7,8]),import.meta.url).then(t=>t.default||t)),Y=a(()=>i(()=>import("./Dhj-axHl.js"),__vite__mapDeps([9,0,1,3,4,5,6,7,10]),import.meta.url).then(t=>t.default||t)),Z=a(()=>i(()=>import("./FX5lqIGh.js"),__vite__mapDeps([11,12,0,1,4,3,5,6,7,13]),import.meta.url).then(t=>t.default||t)),tt=a(()=>i(()=>import("./CQKQ2h2t.js"),__vite__mapDeps([14,0,1,3,15,16,4,5,6,7]),import.meta.url).then(t=>t.default||t)),et={id:"main"},nt={key:1},rt={class:"article-main"},ot=V({__name:"[...slug]",async setup(t){let e,n;const r=j(),c=K(),o=x(),d=B(null);o.sync_route(),o.validate_url(r.public.post_prefix);const g=W(),{data:p}=([e,n]=D(async()=>F(`selected_data_with_surround_${o.path}`,async()=>{const l={},u=C(g).where({_path:o.path}).findOne().then(_=>l.article=_),m=C(g).only(["_path","title","description"]).findSurround(o.path).then(_=>l.surround=_);return await Promise.all([u,m]),l})),e=await e,n(),e);return p.value||(console.error("Article not found, path: %s",o.path),d.value=z({statusCode:404})),c.sync_article(p.value),c.sync_surround(p.value),I({title:`${r.public.name} - ${c.title}`,meta:[{hid:"description",name:"description",content:c.description}]}),(l,u)=>{const m=Q,_=X,A=Y,L=Z,k=tt,R=M;return f(),v("main",et,[h(d)?(f(),T(m,{key:0,error:h(d),path:h(o).path},null,8,["error","path"])):(f(),v("div",nt,[b("div",rt,[s(_),u[0]||(u[0]=b("hr",null,null,-1)),s(A),s(L)]),s(R,null,{default:$(()=>[s(k)]),_:1})]))])}}}),_t=q(ot,[["__scopeId","data-v-ce0ebc44"]]),ut=Object.freeze(Object.defineProperty({__proto__:null,default:_t},Symbol.toStringTag,{value:"Module"}));export{ut as _,K as u};
