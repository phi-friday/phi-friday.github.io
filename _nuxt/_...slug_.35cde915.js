import{_ as U}from"./tag.vue.b1ba95c2.js";import{_ as W}from"./page.vue.1a11efbf.js";import{a as y,k as $,s as O,o as _,b as u,y as n,F as R,x as X,aa as L,ab as P,h as G,u as m,B as g,z as T,A as V,i as I,c as B,w as C,f as h,ad as K,C as b,ae as Q,j as Y,a1 as Z,J as tt,X as et,a3 as nt,H as st,R as N}from"./entry.0271a5d4.js";/* empty css                 */import ot from"./ContentRenderer.bd58e0b2.js";import{u as j,q}from"./query.a4783a6e.js";import{r as E,g as ct}from"./data_type.bda3f72e.js";import"./state.a804f4db.js";import"./ContentRendererMarkdown.f56eaa63.js";import"./utils.c6d731e4.js";const at=y({__name:"comment",setup(e){const t=R(),a=$();return O(()=>{const r=document.createElement("script"),p=t.public.comment;for(const d in p)r.setAttribute(d.replace("_","-"),String(p[d]));a.value&&a.value.appendChild(r)}),(r,p)=>(_(),u("div",null,[n("section",{class:"w-full",ref_key:"self",ref:a},null,512)]))}}),rt=e=>(T("data-v-88742a70"),e=e(),V(),e),it={class:"toc"},lt=rt(()=>n("header",{class:"toc-header"},[n("h3",{class:"text-xl font-bold"},"Table of contents")],-1)),_t={class:"toc-links"},dt=["id","onClick"],ut=["href"],pt=y({__name:"toc",props:{links:null,active_toc_id:null},setup(e){const t=e,a=$(),r=i=>`toc-${i}`;X(()=>t.active_toc_id,()=>{a.value=t.active_toc_id});const p=i=>i.map(s=>{let c=[s];if(s.children){let x=p(s.children);c=[s,...x]}return c}).flat(1),d=i=>{const s={};return s[`_${i.depth}`]=!0,s},f=i=>{a.value=i.id};return(i,s)=>(_(),u("nav",it,[lt,n("ul",_t,[(_(!0),u(L,null,P(p(e.links),c=>(_(),u("li",{key:c.id,id:r(c.id),onClick:x=>f(c),class:G(["toc-link",{...d(c),"font-bold":c.id===m(a)}])},[n("a",{href:`#${c.id}`},g(c.text),9,ut)],10,dt))),128))])]))}}),mt=I(pt,[["__scopeId","data-v-88742a70"]]),ft={class:"prev-next-cont"},ht={class:"link-item prev"},xt={class:"link-item next"},vt=y({__name:"prev_next",props:{prefix:null,prev:null,next:null},setup(e){var d,f;const t=e,a=(i,s)=>s?i?s.startsWith("/")?i+s:i+"/"+s:s:"",r=a(t.prefix,(d=t.prev)==null?void 0:d._path),p=a(t.prefix,(f=t.next)==null?void 0:f._path);return(i,s)=>{const c=Y;return _(),u("ul",ft,[n("li",ht,[e.prev?(_(),B(c,{key:0,to:m(r)},{default:C(()=>[h(m(K),{class:"icon stroke"}),n("span",null,g(e.prev.title),1)]),_:1},8,["to"])):b("",!0)]),n("li",xt,[e.next?(_(),B(c,{key:0,to:m(p)},{default:C(()=>[n("span",null,g(e.next.title),1),h(m(Q),{class:"icon stroke"})]),_:1},8,["to"])):b("",!0)])])}}}),gt=I(vt,[["__scopeId","data-v-3f6c87c4"]]),w=e=>(T("data-v-02303b18"),e=e(),V(),e),$t={class:"article-main"},bt={class:"article-header"},yt={class:"mb-1 heading"},kt={key:0,class:"mb-1 supporting"},wt={key:1,class:"flex-wrap pb-0 article-tags"},Ct=w(()=>n("p",{class:"pt-1 font-mono text-sm font-thin text-slate-400"},"tags:",-1)),It={key:2,class:"flex-wrap mt-0 mb-1 article-tags"},At=w(()=>n("p",{class:"pt-1 font-mono text-sm font-thin text-slate-400"},"page:",-1)),St={class:"font-mono text-sm font-thin text-slate-400"},Bt=w(()=>n("hr",null,null,-1)),Nt={class:"article-section"},jt={class:"aside"},qt={class:"article page"},Et=w(()=>n("p",null,"No content found.",-1)),Ot=y({__name:"post",props:{article:null,prev:null,next:null,prefix:null},setup(e){var k;const t=e,a=/\d{4}-[01]{1}\d{1}-[0-3]{1}\d{1}/;if(!a.test(t.article.date))throw Z({statusCode:400,statusMessage:`invalid date string: ${t.article.date}`});const r=(k=t.article.date.match(a))==null?void 0:k.at(0);tt({title:`${R().public.name} - ${t.article.title}`,meta:[{hid:"description",name:"description",content:t.article.description}]});const d=o=>{if(!o.children)return[];let l=[];for(const v of o.children){if(v.type==="text"){l=[...l,v.value];continue}l=[...l,...d(v)]}return l},f=["h1","h2","h3","h4","h5"],i=t.article.body.children.filter(o=>f.indexOf(o.tag??"")>=0).map(o=>{var l;return{id:(l=o.props)==null?void 0:l.id,depth:f.indexOf(o.tag??"")+1,text:d(o).join("")}}),s=$(),c=$(),x=$(null),A=et({root:c.value,threshold:.5});return O(()=>{x.value=new IntersectionObserver(o=>{o.forEach(l=>{const v=l.target.getAttribute("id");l.isIntersecting&&(s.value=v)})},A),document.querySelectorAll([1,2,3,4,5].map(o=>`.nuxt-content h${o}[id]`).join(", ")).forEach(o=>{var l;(l=x.value)==null||l.observe(o)})}),nt(()=>{var o;(o=x.value)==null||o.disconnect()}),(o,l)=>{var S;const v=U,z=W,D=mt,F=ot,H=gt;return _(),u("div",$t,[n("div",null,[n("header",bt,[n("h1",yt,g(t.article.title),1),e.article.description?(_(),u("p",kt,g(t.article.description),1)):b("",!0),(S=t.article.tags)!=null&&S.length?(_(),u("ul",wt,[Ct,(_(!0),u(L,null,P(t.article.tags,(M,J)=>(_(),u("div",{key:J},[h(v,{tag:M,do_select:!0},null,8,["tag"])]))),128))])):b("",!0),e.article.page?(_(),u("ul",It,[At,h(z,{page:e.article.page,do_select:!0},null,8,["page"])])):b("",!0),n("p",St,"created at: "+g(m(r)),1)])]),Bt,n("div",null,[n("section",Nt,[n("aside",jt,[h(D,{class:"toc",links:m(i),active_toc_id:m(s)},null,8,["links","active_toc_id"])]),n("article",qt,[h(F,{class:"nuxt-content",value:t.article,ref_key:"content",ref:c},{empty:C(()=>[Et]),_:1},8,["value"])])]),h(H,{prev:t.prev,next:t.next,prefix:e.prefix},null,8,["prev","next","prefix"])])])}}}),Rt=I(Ot,[["__scopeId","data-v-02303b18"]]),Lt={id:"main"},Wt=y({__name:"[...slug]",async setup(e){let t,a,{path:r}=st();const p="/"+(r.split("/").at(1)??"");r="/"+r.split("/").slice(2).join("/");const d=ct(),{data:f}=([t,a]=N(()=>j(`selected_data_${r}`,()=>q(d).where({_path:r}).findOne())),t=await t,a(),t),i=E(f),{data:s}=([t,a]=N(()=>j(`selected_surround_${r}`,()=>q(d).only(["_path","title","description"]).findSurround(r))),t=await t,a(),t),c=E(s);return(x,A)=>{const k=Rt,o=at;return _(),u("main",Lt,[h(k,{article:m(i),prev:m(c)[0],next:m(c)[1],prefix:p},null,8,["article","prev","next"]),h(o)])}}});export{Wt as default};
