import{_ as U}from"./tag.vue.97541a63.js";import{_ as X}from"./page.vue.0a4d3747.js";import{a as C,k,s as R,o as u,b as f,y as o,F as L,x as G,aa as M,ab as P,h as K,u as s,B as $,z as T,A as V,i as N,c as q,w as B,f as h,ad as Q,C as w,ae as Y,j as Z,a1 as E,J as tt,X as et,a3 as nt,H as st,R as ot}from"./entry.f9c0e8f8.js";/* empty css                 */import ct from"./ContentRenderer.651127f0.js";import{u as at,q as O}from"./query.ef9a0d20.js";import{g as rt}from"./query.f5aceab6.js";import"./state.a6eb9c41.js";import"./ContentRendererMarkdown.a5babb91.js";import"./utils.c5c2f716.js";const it=C({__name:"comment",setup(e){const t=L(),_=k();return R(()=>{const r=document.createElement("script"),p=t.public.comment;for(const c in p)r.setAttribute(c.replace("_","-"),String(p[c]));_.value&&_.value.appendChild(r)}),(r,p)=>(u(),f("div",null,[o("section",{class:"w-full",ref_key:"self",ref:_},null,512)]))}}),lt=e=>(T("data-v-88742a70"),e=e(),V(),e),_t={class:"toc"},dt=lt(()=>o("header",{class:"toc-header"},[o("h3",{class:"text-xl font-bold"},"Table of contents")],-1)),ut={class:"toc-links"},pt=["id","onClick"],ft=["href"],mt=C({__name:"toc",props:{links:null,active_toc_id:null},setup(e){const t=e,_=k(),r=l=>`toc-${l}`;G(()=>t.active_toc_id,()=>{_.value=t.active_toc_id});const p=l=>l.map(n=>{let i=[n];if(n.children){let v=p(n.children);i=[n,...v]}return i}).flat(1),c=l=>{const n={};return n[`_${l.depth}`]=!0,n},m=l=>{_.value=l.id};return(l,n)=>(u(),f("nav",_t,[dt,o("ul",ut,[(u(!0),f(M,null,P(p(e.links),i=>(u(),f("li",{key:i.id,id:r(i.id),onClick:v=>m(i),class:K(["toc-link",{...c(i),"font-bold":i.id===s(_)}])},[o("a",{href:`#${i.id}`},$(i.text),9,ft)],10,pt))),128))])]))}}),ht=N(mt,[["__scopeId","data-v-88742a70"]]),vt={class:"prev-next-cont"},xt={class:"link-item prev"},gt={class:"link-item next"},$t=C({__name:"prev_next",props:{prefix:null,prev:null,next:null},setup(e){var c,m;const t=e,_=(l,n)=>n?l?n.startsWith("/")?l+n:l+"/"+n:n:"",r=_(t.prefix,(c=t.prev)==null?void 0:c._path),p=_(t.prefix,(m=t.next)==null?void 0:m._path);return(l,n)=>{const i=Z;return u(),f("ul",vt,[o("li",xt,[e.prev?(u(),q(i,{key:0,to:s(r)},{default:B(()=>[h(s(Q),{class:"icon stroke"}),o("span",null,$(e.prev.title),1)]),_:1},8,["to"])):w("",!0)]),o("li",gt,[e.next?(u(),q(i,{key:0,to:s(p)},{default:B(()=>[o("span",null,$(e.next.title),1),h(s(Y),{class:"icon stroke"})]),_:1},8,["to"])):w("",!0)])])}}}),yt=N($t,[["__scopeId","data-v-3f6c87c4"]]),S=e=>(T("data-v-7e1ca15e"),e=e(),V(),e),bt={class:"article-main"},kt={class:"article-header"},wt={class:"mb-1 heading"},Ct={key:0,class:"mb-1 supporting"},It={key:1,class:"flex-wrap pb-0 article-tags"},At=S(()=>o("p",{class:"pt-1 font-mono text-sm font-thin text-slate-400"},"tags:",-1)),St={key:2,class:"flex-wrap mt-0 mb-1 article-tags"},Bt=S(()=>o("p",{class:"pt-1 font-mono text-sm font-thin text-slate-400"},"page:",-1)),Nt={class:"font-mono text-sm font-thin text-slate-400"},jt=S(()=>o("hr",null,null,-1)),qt={class:"article-section"},Et={class:"aside"},Ot={class:"article page"},Rt=S(()=>o("p",null,"No content found.",-1)),Lt=C({__name:"post",props:{article:null,prev:null,next:null,prefix:null},setup(e){var A;const t=e,_=/\d{4}-[01]{1}\d{1}-[0-3]{1}\d{1}/,r=t.prev??void 0,p=t.next??void 0;let c;if(t.article)c=t.article;else throw E({statusCode:500,statusMessage:`invaild article type: ${typeof t.article}`});if(!_.test(t.article.date))throw E({statusCode:400,statusMessage:`invalid date string: ${t.article.date}`});const m=(A=t.article.date.match(_))==null?void 0:A.at(0);tt({title:`${L().public.name} - ${t.article.title}`,meta:[{hid:"description",name:"description",content:t.article.description}]});const n=a=>{if(!a.children)return[];let d=[];for(const x of a.children){if(x.type==="text"){d=[...d,x.value];continue}d=[...d,...n(x)]}return d},i=["h1","h2","h3","h4","h5"],v=t.article.body.children.filter(a=>i.indexOf(a.tag??"")>=0).map(a=>{var d;return{id:(d=a.props)==null?void 0:d.id,depth:i.indexOf(a.tag??"")+1,text:n(a).join("")}}),y=k(),b=k(),g=k(null),I=et({root:b.value,threshold:.5});return R(()=>{g.value=new IntersectionObserver(a=>{a.forEach(d=>{const x=d.target.getAttribute("id");d.isIntersecting&&(y.value=x)})},I),document.querySelectorAll([1,2,3,4,5].map(a=>`.nuxt-content h${a}[id]`).join(", ")).forEach(a=>{var d;(d=g.value)==null||d.observe(a)})}),nt(()=>{var a;(a=g.value)==null||a.disconnect()}),(a,d)=>{var j;const x=U,z=X,D=ht,F=ct,H=yt;return u(),f("div",bt,[o("div",null,[o("header",kt,[o("h1",wt,$(s(c).title),1),s(c).description?(u(),f("p",Ct,$(s(c).description),1)):w("",!0),(j=s(c).tags)!=null&&j.length?(u(),f("ul",It,[At,(u(!0),f(M,null,P(s(c).tags,(W,J)=>(u(),f("div",{key:J},[h(x,{tag:W,do_select:!0},null,8,["tag"])]))),128))])):w("",!0),s(c).page?(u(),f("ul",St,[Bt,h(z,{page:s(c).page,do_select:!0},null,8,["page"])])):w("",!0),o("p",Nt,"created at: "+$(s(m)),1)])]),jt,o("div",null,[o("section",qt,[o("aside",Et,[h(D,{class:"toc",links:s(v),active_toc_id:s(y)},null,8,["links","active_toc_id"])]),o("article",Ot,[h(F,{class:"nuxt-content",value:s(c),ref_key:"content",ref:b},{empty:B(()=>[Rt]),_:1},8,["value"])])]),h(H,{prev:s(r),next:s(p),prefix:e.prefix},null,8,["prev","next","prefix"])])])}}}),Mt=N(Lt,[["__scopeId","data-v-7e1ca15e"]]),Pt={id:"main"},Gt=C({__name:"[...slug]",async setup(e){var v,y,b;let t,_,{path:r}=st();const p="/"+(r.split("/").at(1)??"");r="/"+r.split("/").slice(2).join("/"),r.endsWith("/")&&(r=r.slice(0,-1));const c=rt(),{data:m}=([t,_]=ot(async()=>at(`selected_data_with_surround_${r}`,async()=>{const g=O(c).where({_path:r}).findOne(),I=O(c).only(["_path","title","description"]).findSurround(r);return{article:await g,surround:await I}})),t=await t,_(),t);let l,n;(v=m.value)!=null&&v.surround&&([l,n]=(y=m.value)==null?void 0:y.surround);const i=(b=m.value)==null?void 0:b.article;return(g,I)=>{const A=Mt,a=it;return u(),f("main",Pt,[h(A,{article:s(i),prev:s(l),next:s(n),prefix:p},null,8,["article","prev","next"]),h(a)])}}});export{Gt as default};
