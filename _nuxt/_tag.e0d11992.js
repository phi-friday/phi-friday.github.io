import{a as z,a1 as G,o as i,b as _,f,w as D,y as a,B as q,u as e,aa as S,ab as R,j as E,k as N,s as F,x as H,a8 as K,ag as O,h as T,F as M,z as Q,A as U,i as X,H as Y,v as C,R as Z,J as tt}from"./entry.0d4d7c07.js";import{_ as P}from"./tag.vue.dcf28140.js";import{c as V,a as et,s as at,d as st}from"./state.cef56aeb.js";/* empty css                 */import{_ as nt}from"./pagination.7e21f0ce.js";import{u as ot,q as rt}from"./query.c3a094c0.js";import{r as lt,g as ct}from"./data_type.bda3f72e.js";/* empty css                       */import"./utils.2861b96a.js";const it={class:"wrapper"},_t={class:"text-2xl font-semibold"},ut={class:"flex-wrap article-tags"},dt={class:"font-mono text-sm font-thin text-slate-400"},pt=z({__name:"tag_item",props:{article:null,post_prefix:null,tag_prefix:null},setup(m){var k;const u=m,c=u.article,n=/\d{4}-[01]{1}\d{1}-[0-3]{1}\d{1}/;if(!n.test(c.date))throw G({statusCode:400,statusMessage:`invalid date string: ${c.date}`});const d=(k=c.date.match(n))==null?void 0:k.at(0),$=[...new Set(c.tags)].sort((t,g)=>t.localeCompare(g)),y=(t,g,r=void 0)=>{let o=r;return o||(g==="post"?o=u.post_prefix:o=u.tag_prefix),!t||!o?t??void 0:t.startsWith("/")?o+t:o+"/"+t};return(t,g)=>{const r=P,o=E;return i(),_("div",null,[f(o,{to:y(e(c)._path,"post")},{default:D(()=>[a("div",it,[a("header",null,[a("h1",_t,q(e(c).title),1),a("p",null,q(e(c).description),1),a("ul",ut,[(i(!0),_(S,null,R(e($),(w,l)=>(i(),_("div",{key:l},[f(r,{tag:w,add_tag:!0},null,8,["tag"])]))),128))]),a("p",dt," created at: "+q(e(d)),1)])])]),_:1},8,["to"])])}}}),j=m=>(Q("data-v-aa837df7"),m=m(),U(),m),gt={class:"mb-2"},ft={class:"flex row-span-1 row-start-1 gap-x-2"},mt=j(()=>a("span",null," Reset",-1)),xt=j(()=>a("span",null,"Tags",-1)),vt=z({__name:"tags",props:{tag_data:null},setup(m){const u=m,c=M(),n=(l,p=void 0)=>l.map(v=>{let b=v;return v[p]&&(b=n(v[p])),b}).flat(1),d=V(),$=()=>{d.value.clear()},k=[...new Set(n(u.tag_data,"tags"))].filter(l=>typeof l=="string").sort((l,p)=>l.localeCompare(p)),t=et(),g=()=>{at(!t.value,t)},r=N(),o=N(),w=()=>{var l,p;t.value?(l=r.value)==null||l.appendChild(o.value):(p=r.value)==null||p.removeChild(o.value)};return F(()=>w()),H(()=>t.value,()=>w()),(l,p)=>{const x=E,v=P;return i(),_(S,null,[a("div",gt,[a("div",ft,[a("div",{class:"cta w-icon",onClick:$},[f(x,{to:`${e(c).public.tag_prefix}`},{default:D(()=>[f(e(K),{class:"icon solid"}),mt]),_:1},8,["to"])]),a("button",{onClick:g,class:"cta w-icon"},[f(e(O),{class:"icon solid"}),xt])])]),a("div",{class:T(["tag-list",{active:e(t)}]),ref_key:"tag_parent_ref",ref:r},[a("ul",{class:T(["flex flex-wrap article-tags",{expanded:e(t)}]),ref_key:"tag_ref",ref:o},[(i(!0),_(S,null,R(e(k),(b,A)=>(i(),_("div",{key:A},[f(v,{class:"font-semibold",tag:b,add_tag:!0},null,8,["tag"])]))),128))],2)],2)],64)}}}),ht=X(vt,[["__scopeId","data-v-aa837df7"]]),yt={class:"page-heading"},kt={class:"wrapper"},wt={class:"text-5xl font-extrabold"},bt={class:"page-section"},$t={key:0,class:"article-list"},Ct={key:1},Lt=z({__name:"@tag",async setup(m){let u,c;const n=Y(),d=M(),$=()=>{let s;return!n.query.page||Array.isArray(n.query.page)?s=1:s=Number(n.query.page),s||(s=1),s},y=d.public.default_limit,k=()=>{const s=$();return d.public.default_skip+y*(s-1)},t=N(),g=()=>{t.value=k()};g();const r=V(),o=C(()=>[...r.value].sort((s,h)=>s.localeCompare(h))),w=ct(),{data:l}=([u,c]=Z(()=>ot("maybe_tagged_data",()=>rt(w).only(["title","description","tags","_path","date"]).skip(d.public.default_skip).find())),u=await u,c(),u),p=lt(l),x=C(()=>p.value.filter(s=>{var h;return(h=s.tags)==null?void 0:h.length})),v=C(()=>{const s=r.value;return s.size===0?x.value.slice(t.value,t.value+y):x.value.filter(h=>[...new Set(h.tags)].filter(I=>s.has(I)).length==s.size).slice(t.value,t.value+y)});F(()=>{if(n.query.select&&!Array.isArray(n.query.select)){for(const s of x.value)if(s.tags&&s.tags.includes(n.query.select)){r.value.clear(),r.value.add(n.query.select);break}}}),H(()=>n.query,()=>{g()});const b=st(),A=C(()=>`All tagged posts: ${b.value}`),B=C(()=>{if(r.value.size>0)return`Selected tags: ${o.value}`});return tt({title:`${d.public.name} - All tagged posts`,meta:[{hid:"description",name:"description",content:"All posts with tags"}]}),(s,h)=>{const I=ht,J=pt,W=nt;return i(),_("main",null,[a("header",yt,[a("div",kt,[a("h1",wt,q(e(A)),1),a("p",{class:T(["text-lg font-medium",{"text-transparent":e(B)===null}])},q(e(B)||"â €"),3)])]),a("div",null,[a("section",bt,[f(I,{tag_data:e(x)},null,8,["tag_data"]),e(v).length>0?(i(),_("ul",$t,[(i(!0),_(S,null,R(e(v),L=>(i(),_("li",{key:L._path,class:"article-item"},[f(J,{article:L,post_prefix:e(d).public.post_prefix,tag_prefix:e(d).public.tag_prefix},null,8,["article","post_prefix","tag_prefix"])]))),128))])):(i(),_("p",Ct,"No articles found."))]),f(W,{count_data:e(x),how:"tag"},null,8,["count_data"])])])}}});export{Lt as default};
