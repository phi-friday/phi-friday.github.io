import{a as P,$ as D,o as g,f,l as m,y as E,i as t,E as w,u as a,L,b as y,ag as M,ah as T,r as q,H as R,N as B,ai as U,aj as X,F as A,D as I,p as F,e as H,ak as O,al as Y,P as Z,am as ee,S as te,an as ae,a6 as se,ao as ne}from"./entry.a909e591.js";import{_ as V}from"./one.vue.a2938229.js";import{_ as oe}from"./pagination.cae65a1b.js";import{u as re}from"./asyncData.33f0c997.js";import{g as le}from"./query.f5aceab6.js";import{q as ce}from"./query.8ee6e2dd.js";import{r as pe}from"./data_type.9bdab8d3.js";/* empty css                       */import"./utils.cc42cb99.js";const ie={class:"wrapper"},_e={class:"text-2xl font-semibold"},ue={class:"flex-wrap article-tags"},de={class:"font-mono text-sm font-thin text-slate-400"},ge=P({__name:"item",props:{article:null,post_prefix:null,page_prefix:null},setup(k){var x;const p=k,o=p.article,r=/\d{4}-[01]{1}\d{1}-[0-3]{1}\d{1}/;if(r.test(o.date)){if(!o.page)throw D({statusCode:400,statusMessage:"article has no page"})}else throw D({statusCode:400,statusMessage:`invalid date string: ${o.date}`});const i=(x=o.date.match(r))==null?void 0:x.at(0),u=(l,c,d=void 0)=>{let s=d;return s||(c==="post"?s=p.post_prefix:s=p.page_prefix),!l||!s?l??void 0:l.startsWith("/")?s+l:s+"/"+l};return(l,c)=>{const d=V,s=L;return g(),f("div",null,[m(s,{to:u(a(o)._path,"post")},{default:E(()=>[t("div",ie,[t("header",null,[t("h1",_e,w(a(o).title),1),t("p",null,w(a(o).description),1),t("ul",ue,[m(d,{page:a(o).page,add_page:!0},null,8,["page"])]),t("p",de," created at: "+w(a(i)),1)])])]),_:1},8,["to"])])}}}),fe={class:"mb-2"},me={class:"flex row-span-1 row-start-1 gap-x-2"},xe=t("span",null," Reset",-1),ve=t("span",null,"Pages",-1),he=P({__name:"select",props:{page_data:null},setup(k){const p=k,o=H(),r=()=>{O(new Set)},i=y(()=>{const s=M();return[...new Set(p.page_data.map(n=>n.page))].map(n=>[n,s.value.get(n)??0]).sort((n,h)=>n[1]===h[1]?n[0].localeCompare(h[0]):h[1]>n[1]?1:-1)}),u=T(),x=()=>{Y(!u.value,u)},l=q(),c=q(),d=()=>{var s,n;u.value?(s=l.value)==null||s.appendChild(c.value):(n=l.value)==null||n.removeChild(c.value)};return R(()=>d()),B(()=>u.value,()=>d()),(s,n)=>{const h=L,b=V;return g(),f(A,null,[t("div",fe,[t("div",me,[t("div",{class:"cta w-icon",onClick:r},[m(h,{to:`${a(o).public.page_prefix}`},{default:E(()=>[m(a(U),{class:"icon solid"}),xe]),_:1},8,["to"])]),t("button",{onClick:x,class:"cta w-icon"},[m(a(X),{class:"icon solid"}),ve])])]),t("div",{class:F(["tag-list",{active:a(u)}]),ref_key:"page_parent_ref",ref:l},[t("ul",{class:"flex flex-wrap article-tags",ref_key:"page_ref",ref:c},[(g(!0),f(A,null,I(a(i),([$,v],C)=>(g(),f("div",{key:C},[m(b,{class:"font-semibold",page:$,count:v,add_page:!0},null,8,["page","count"])]))),128))],512)],2)],64)}}}),ye={class:"page-heading"},we={class:"wrapper"},ke={class:"text-5xl font-extrabold"},be={class:"page-section"},$e={key:0,class:"article-list"},Ce={key:1},Me=P({__name:"@page",async setup(k){let p,o;const r=Z(),i=H(),u=()=>{let e;return!r.query.page||Array.isArray(r.query.page)?e=1:e=Number(r.query.page),e||(e=1),e},x=i.public.default_limit,l=()=>{const e=u();return i.public.default_skip+x*(e-1)},c=q(),d=()=>{c.value=l()};d();const s=ee(),n=y(()=>[...s.value].sort((e,_)=>e.localeCompare(_))),h=le(),{data:b}=([p,o]=te(()=>re("maybe_page_data",()=>ce(h).only(["title","page","description","_path","date"]).skip(i.public.default_skip).find())),p=await p,o(),p),$=pe(b),v=y(()=>$.value.filter(e=>{var _;return(_=e.page)==null?void 0:_.length})),C=y(()=>M().value.size>0),j=()=>{if(C.value)return;const e=new Map;v.value.forEach(_=>{e.set(_.page,(e.get(_.page)??0)+1)}),ne(e)},S=y(()=>{j();const e=s.value;return e.size===0?v.value.slice(c.value,c.value+x):v.value.filter(_=>e.has(_.page)).slice(c.value,c.value+x)});R(()=>{r.query.select&&!Array.isArray(r.query.select)&&v.value.map(e=>e.page).includes(r.query.select)&&O(new Set([r.query.select]))}),B(()=>r.query,()=>{d()});const W=ae(),G=y(()=>`All pages: ${W.value}`),N=y(()=>{if(s.value.size>0)return`Selected pages: ${n.value}`});return se({title:`${i.public.name} - All pages`,meta:[{hid:"description",name:"description",content:"All posts with pages"}]}),(e,_)=>{const J=he,K=ge,Q=oe;return g(),f("main",null,[t("header",ye,[t("div",we,[t("h1",ke,w(a(G)),1),t("p",{class:F(["text-lg font-medium",{"text-transparent":a(N)===null}])},w(a(N)||"â €"),3)])]),t("div",null,[t("section",be,[m(J,{page_data:a(v)},null,8,["page_data"]),a(S).length>0?(g(),f("ul",$e,[(g(!0),f(A,null,I(a(S),z=>(g(),f("li",{key:z._path,class:"article-item"},[m(K,{article:z,post_prefix:a(i).public.post_prefix,page_prefix:a(i).public.page_prefix},null,8,["article","post_prefix","page_prefix"])]))),128))])):(g(),f("p",Ce,"No articles found."))]),m(Q,{count_data:a(v),how:"page"},null,8,["count_data"])])])}}});export{Me as default};
