import{_ as G}from"./tag.vue.bae38f10.js";import{_ as K}from"./page.vue.89d1a84a.js";import{a as k,k as $,s as P,o as _,b as m,y as n,F as T,x as Q,aa as V,ab as z,h as Y,u as d,B as g,z as D,A as F,i as S,c as j,w as A,f,ad as Z,C as y,ae as tt,j as et,a1 as nt,J as st,X as ot,a3 as ct,H as at,R as q,v as E}from"./entry.7ea00f58.js";/* empty css                 */import rt from"./ContentRenderer.a96f26e1.js";import{u as O,q as R}from"./query.b66955f7.js";import{r as L,g as it}from"./data_type.bda3f72e.js";import"./state.b65a0d9c.js";import"./ContentRendererMarkdown.008a2528.js";import"./utils.c9b2bd9c.js";const lt=k({__name:"comment",setup(e){const t=T(),c=$();return P(()=>{const i=document.createElement("script"),u=t.public.comment;for(const p in u)i.setAttribute(p.replace("_","-"),String(u[p]));c.value&&c.value.appendChild(i)}),(i,u)=>(_(),m("div",null,[n("section",{class:"w-full",ref_key:"self",ref:c},null,512)]))}}),_t=e=>(D("data-v-88742a70"),e=e(),F(),e),dt={class:"toc"},ut=_t(()=>n("header",{class:"toc-header"},[n("h3",{class:"text-xl font-bold"},"Table of contents")],-1)),pt={class:"toc-links"},mt=["id","onClick"],ft=["href"],ht=k({__name:"toc",props:{links:null,active_toc_id:null},setup(e){const t=e,c=$(),i=a=>`toc-${a}`;Q(()=>t.active_toc_id,()=>{c.value=t.active_toc_id});const u=a=>a.map(s=>{let r=[s];if(s.children){let v=u(s.children);r=[s,...v]}return r}).flat(1),p=a=>{const s={};return s[`_${a.depth}`]=!0,s},h=a=>{c.value=a.id};return(a,s)=>(_(),m("nav",dt,[ut,n("ul",pt,[(_(!0),m(V,null,z(u(e.links),r=>(_(),m("li",{key:r.id,id:i(r.id),onClick:v=>h(r),class:Y(["toc-link",{...p(r),"font-bold":r.id===d(c)}])},[n("a",{href:`#${r.id}`},g(r.text),9,ft)],10,mt))),128))])]))}}),vt=S(ht,[["__scopeId","data-v-88742a70"]]),xt={class:"prev-next-cont"},gt={class:"link-item prev"},$t={class:"link-item next"},yt=k({__name:"prev_next",props:{prefix:null,prev:null,next:null},setup(e){var p,h;const t=e,c=(a,s)=>s?a?s.startsWith("/")?a+s:a+"/"+s:s:"",i=c(t.prefix,(p=t.prev)==null?void 0:p._path),u=c(t.prefix,(h=t.next)==null?void 0:h._path);return(a,s)=>{const r=et;return _(),m("ul",xt,[n("li",gt,[e.prev?(_(),j(r,{key:0,to:d(i)},{default:A(()=>[f(d(Z),{class:"icon stroke"}),n("span",null,g(e.prev.title),1)]),_:1},8,["to"])):y("",!0)]),n("li",$t,[e.next?(_(),j(r,{key:0,to:d(u)},{default:A(()=>[n("span",null,g(e.next.title),1),f(d(tt),{class:"icon stroke"})]),_:1},8,["to"])):y("",!0)])])}}}),kt=S(yt,[["__scopeId","data-v-3f6c87c4"]]),I=e=>(D("data-v-90392af7"),e=e(),F(),e),bt={class:"article-main"},wt={class:"article-header"},Ct={class:"mb-1 heading"},It={key:0,class:"mb-1 supporting"},At={key:1,class:"flex-wrap pb-0 article-tags"},St=I(()=>n("p",{class:"pt-1 font-mono text-sm font-thin text-slate-400"},"tags:",-1)),Bt={key:2,class:"flex-wrap mt-0 mb-1 article-tags"},Nt=I(()=>n("p",{class:"pt-1 font-mono text-sm font-thin text-slate-400"},"page:",-1)),jt={class:"font-mono text-sm font-thin text-slate-400"},qt=I(()=>n("hr",null,null,-1)),Et={class:"article-section"},Ot={class:"aside"},Rt={class:"article page"},Lt=I(()=>n("p",null,"No content found.",-1)),Pt=k({__name:"post",props:{article:null,prev:null,next:null,prefix:null},setup(e){var C;const t=e,c=/\d{4}-[01]{1}\d{1}-[0-3]{1}\d{1}/,i=t.prev??void 0,u=t.next??void 0;if(!c.test(t.article.date))throw nt({statusCode:400,statusMessage:`invalid date string: ${t.article.date}`});const p=(C=t.article.date.match(c))==null?void 0:C.at(0);st({title:`${T().public.name} - ${t.article.title}`,meta:[{hid:"description",name:"description",content:t.article.description}]});const a=o=>{if(!o.children)return[];let l=[];for(const x of o.children){if(x.type==="text"){l=[...l,x.value];continue}l=[...l,...a(x)]}return l},s=["h1","h2","h3","h4","h5"],r=t.article.body.children.filter(o=>s.indexOf(o.tag??"")>=0).map(o=>{var l;return{id:(l=o.props)==null?void 0:l.id,depth:s.indexOf(o.tag??"")+1,text:a(o).join("")}}),v=$(),b=$(),w=$(null),B=ot({root:b.value,threshold:.5});return P(()=>{w.value=new IntersectionObserver(o=>{o.forEach(l=>{const x=l.target.getAttribute("id");l.isIntersecting&&(v.value=x)})},B),document.querySelectorAll([1,2,3,4,5].map(o=>`.nuxt-content h${o}[id]`).join(", ")).forEach(o=>{var l;(l=w.value)==null||l.observe(o)})}),ct(()=>{var o;(o=w.value)==null||o.disconnect()}),(o,l)=>{var N;const x=G,H=K,M=vt,J=rt,U=kt;return _(),m("div",bt,[n("div",null,[n("header",wt,[n("h1",Ct,g(t.article.title),1),e.article.description?(_(),m("p",It,g(t.article.description),1)):y("",!0),(N=t.article.tags)!=null&&N.length?(_(),m("ul",At,[St,(_(!0),m(V,null,z(t.article.tags,(W,X)=>(_(),m("div",{key:X},[f(x,{tag:W,do_select:!0},null,8,["tag"])]))),128))])):y("",!0),e.article.page?(_(),m("ul",Bt,[Nt,f(H,{page:e.article.page,do_select:!0},null,8,["page"])])):y("",!0),n("p",jt,"created at: "+g(d(p)),1)])]),qt,n("div",null,[n("section",Et,[n("aside",Ot,[f(M,{class:"toc",links:d(r),active_toc_id:d(v)},null,8,["links","active_toc_id"])]),n("article",Rt,[f(J,{class:"nuxt-content",value:t.article,ref_key:"content",ref:b},{empty:A(()=>[Lt]),_:1},8,["value"])])]),f(U,{prev:d(i),next:d(u),prefix:e.prefix},null,8,["prev","next","prefix"])])])}}}),Tt=S(Pt,[["__scopeId","data-v-90392af7"]]),Vt={id:"main"},Kt=k({__name:"[...slug]",async setup(e){let t,c,{path:i}=at();const u="/"+(i.split("/").at(1)??"");i="/"+i.split("/").slice(2).join("/");const p=it(),{data:h}=([t,c]=q(()=>O(`selected_data_${i}`,()=>R(p).where({_path:i}).findOne())),t=await t,c(),t),a=L(h),{data:s}=([t,c]=q(()=>O(`selected_surround_${i}`,()=>R(p).only(["_path","title","description","date"]).findSurround(i))),t=await t,c(),t),r=L(s),v=E(()=>r.value[0]),b=E(()=>r.value[-1]);return(w,B)=>{const C=Tt,o=lt;return _(),m("main",Vt,[f(C,{article:d(a),prev:d(v),next:d(b),prefix:u},null,8,["article","prev","next"]),f(o)])}}});export{Kt as default};
