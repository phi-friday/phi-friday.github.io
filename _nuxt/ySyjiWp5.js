const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./C0cm_az9.js","./entry.4uPfcvK_.css","./ekP2DFJe.js","./BoBFeiPE.js","./4-M8tXrb.js","./BqB4qWRx.js","./C8Bkx1Sc.js","./CBOkc3wT.js","./Cq3p5OeP.js","./header.Bvq2yFZ7.css","./B8Ou1yRo.js","./body.BtuWHAZE.css","./CASD7vSa.js","./7bQP6aSf.js","./footer.Dsvu2t9t.css","./C8iKIZPD.js","./CeePm7QY.js"])))=>i.map(i=>d[i]);
import{c as O,d as A,u as B,a as $,r as g,w as j,b as q,e as F,f as P,g as u,h as d,i as k,j as p,k as M,F as N,l as H,o as m,m as W,n as a,_ as i,p as U}from"./C0cm_az9.js";import{_ as G}from"./BoBFeiPE.js";import{u as J}from"./4-M8tXrb.js";import{g as K}from"./BqB4qWRx.js";import{u as Q,q as w}from"./C8Bkx1Sc.js";import{p as X,v as Y}from"./Cq3p5OeP.js";function Z(t,e=500){if(!t)throw O({statusCode:Math.floor(e),statusMessage:`invaild article type: ${typeof t}`});return t}const tt=/\d{4}-[01]{1}\d{1}-[0-3]{1}\d{1}/,et=t=>{var e;return t=(e=t.match(tt))==null?void 0:e.at(0)},b=A({id:"current_url",state:()=>({route_path:null}),getters:{path:t=>X(t.route_path||""),prefix:t=>{var e;return"/"+(((e=t.route_path)==null?void 0:e.split("/").at(1))??"")}},actions:{sync_route(){const{path:t}=B();this.route_path=t},validate_url(t){Y(t,this.path)}}}),v=["h1","h2","h3","h4","h5"],z=(t,e)=>e?(e.endsWith("/")||(e=e+"/"),t?e.startsWith("/")?t+e:t+"/"+e:e):"",L=t=>t.map(e=>{let n=[e];if(e.children){const r=L(e.children);n=[e,...r]}return n}).flat(1),V=t=>{if(!t.children)return[];let e=[];for(const n of t.children){if(n.type==="text"){e=[...e,n.value];continue}e=[...e,...V(n)]}return e},nt=A({id:"current_article",state:()=>({nullable_article:null,prev:null,next:null,active_toc_ids:new Set}),getters:{article:t=>Z(t.nullable_article),date:t=>{var e;return et(((e=t.nullable_article)==null?void 0:e.date)||"")},title:t=>{var e;return((e=t.nullable_article)==null?void 0:e.title)||""},tags:t=>{var e;return((e=t.nullable_article)==null?void 0:e.tags)||[]},description:t=>{var e;return((e=t.nullable_article)==null?void 0:e.description)||""},prev_path:t=>{var n;const e=b();return z(e.prefix,(n=t.prev)==null?void 0:n._path)},next_path:t=>{var n;const e=b();return z(e.prefix,(n=t.next)==null?void 0:n._path)},toc_tags:()=>v,toc_links:t=>{var e;return((e=t.nullable_article)==null?void 0:e.body.children.filter(n=>v.indexOf(n.tag??"")>=0).map(n=>{var r;return{id:(r=n.props)==null?void 0:r.id,depth:v.indexOf(n.tag??"")+1,text:V(n).join("")}}))??[]},active_toc_ids_array:t=>[...t.active_toc_ids],flatten_toc_links:()=>L},actions:{set_article(t){this.nullable_article=t||null,this.active_toc_ids.clear()},set_prev(t){this.prev=t||null},set_next(t){this.next=t||null},sync_article(t){this.set_article(t==null?void 0:t.article)},sync_surround(t){var e,n;this.set_prev((e=t==null?void 0:t.surround)==null?void 0:e[0]),this.set_next((n=t==null?void 0:t.surround)==null?void 0:n[1])},set_active_toc_id(t){this.active_toc_ids.clear(),this.active_toc_ids.add(t.id)}}}),rt=a(()=>i(()=>import("./C0cm_az9.js").then(t=>t.au),__vite__mapDeps([0,1]),import.meta.url).then(t=>t.default||t)),ot=a(()=>i(()=>import("./ekP2DFJe.js"),__vite__mapDeps([2,0,1,3,4,5,6,7,8,9]),import.meta.url).then(t=>t.default||t)),_t=a(()=>i(()=>import("./B8Ou1yRo.js"),__vite__mapDeps([10,0,1,3,4,5,6,7,8,11]),import.meta.url).then(t=>t.default||t)),st=a(()=>i(()=>import("./CASD7vSa.js"),__vite__mapDeps([12,13,0,1,8,3,4,5,6,7,14]),import.meta.url).then(t=>t.default||t)),at=a(()=>i(()=>import("./C8iKIZPD.js"),__vite__mapDeps([15,3,0,1,16]),import.meta.url).then(t=>t.default||t)),it={id:"main"},lt={key:1},ct={class:"article-main"},ut=$({__name:"[...slug]",async setup(t){let e,n;const r=H(),l=nt(),o=b(),h=g(null),C=g(null),R=J(C,{threshold:.1}),f=g(!1);j(R,_=>{f.value||(f.value=_)}),o.sync_route(),o.validate_url(r.public.post_prefix);const E=K(),{data:y}=([e,n]=q(async()=>Q(`selected_data_with_surround_${o.path}`,async()=>{const _={},c=w(E).where({_path:o.path}).findOne().then(s=>_.article=s),x=w(E).only(["_path","title","description"]).findSurround(o.path).then(s=>_.surround=s);return await Promise.all([c,x]),_})),e=await e,n(),e);return y.value||(console.error("Article not found, path: %s",o.path),h.value=O({statusCode:404})),l.sync_article(y.value),l.sync_surround(y.value),F({title:`${r.public.name} - ${l.title}`,meta:[{hid:"description",name:"description",content:l.description}]}),(_,c)=>{const x=rt,s=ot,S=_t,D=st,I=at,T=G;return m(),P(N,null,[u("main",it,[d(h)?(m(),k(x,{key:0,error:d(h),path:d(o).path},null,8,["error","path"])):(m(),P("div",lt,[u("div",ct,[p(s),c[0]||(c[0]=u("hr",null,null,-1)),p(S),p(D)]),p(T,null,{default:M(()=>[d(f)?(m(),k(I,{key:0})):W("",!0)]),_:1})]))]),u("div",{ref_key:"comment_flag",ref:C},null,512)],64)}}}),dt=U(ut,[["__scopeId","data-v-fae2411b"]]),gt=Object.freeze(Object.defineProperty({__proto__:null,default:dt},Symbol.toStringTag,{value:"Module"}));export{gt as _,nt as u};
