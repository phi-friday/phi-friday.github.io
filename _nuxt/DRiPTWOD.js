import{H as l,I as h,c as p}from"./CsUWno4I.js";import{p as f,v as T}from"./mJK12ZLw.js";const s=l({id:"current_url",state:()=>({route_path:null}),getters:{path:t=>f(t.route_path||""),prefix:t=>{var e;return"/"+(((e=t.route_path)==null?void 0:e.split("/").at(1))??"")}},actions:{sync_route(){const{path:t}=h();this.route_path=t},validate_url(t){T(t,this.path)}}});function g(t,e=500){if(!t)throw p({statusCode:Math.floor(e),statusMessage:`invaild article type: ${typeof t}`});return t}const o=/\d{4}-[01]{1}\d{1}-[0-3]{1}\d{1}/,b=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}/,m=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}([+-]\d{2}:\d{2}|Z)/,x=9*60,E=t=>{var e;return t=(e=t.match(o))==null?void 0:e.at(0)},i=t=>{var e;for(const r of[m,b,o])if(r.test(t))return(e=t.match(r))==null?void 0:e.at(0);return""},_=t=>{const e=new Date(t),r=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return new Date(r).toISOString()},y=t=>{const e=_(t),r=new Date(e);return new Date(r.getTime()+x*60*1e3).toISOString().replace(/Z$/,"+09:00")},a=["h1","h2","h3","h4","h5"],c=(t,e)=>e?(e.endsWith("/")||(e=e+"/"),t?e.startsWith("/")?t+e:t+"/"+e:e):"",d=t=>t.map(e=>{let r=[e];if(e.children){const n=d(e.children);r=[e,...n]}return r}).flat(1),u=t=>{if(!t.children)return[];let e=[];for(const r of t.children){if(r.type==="text"){e=[...e,r.value];continue}e=[...e,...u(r)]}return e},D=l({id:"current_article",state:()=>({nullable_article:null,prev:null,next:null,active_toc_ids:new Set}),getters:{article:t=>g(t.nullable_article),date:t=>{var e;return E(((e=t.nullable_article)==null?void 0:e.date)||"")},datetime:t=>{var e;return i(((e=t.nullable_article)==null?void 0:e.date)||"")},utc_datetime:t=>{var r;if(!((r=t.nullable_article)!=null&&r.date))return"";const e=i(t.nullable_article.date);return e?_(e):""},kst_datetime:t=>{var r;if(!((r=t.nullable_article)!=null&&r.date))return"";const e=i(t.nullable_article.date);return e?y(e):""},title:t=>{var e;return((e=t.nullable_article)==null?void 0:e.title)||""},tags:t=>{var e;return((e=t.nullable_article)==null?void 0:e.tags)||[]},description:t=>{var e;return((e=t.nullable_article)==null?void 0:e.description)||""},prev_path:t=>{var r;const e=s();return c(e.prefix,(r=t.prev)==null?void 0:r._path)},next_path:t=>{var r;const e=s();return c(e.prefix,(r=t.next)==null?void 0:r._path)},toc_tags:()=>a,toc_links:t=>{var e;return((e=t.nullable_article)==null?void 0:e.body.children.filter(r=>a.indexOf(r.tag??"")>=0).map(r=>{var n;return{id:(n=r.props)==null?void 0:n.id,depth:a.indexOf(r.tag??"")+1,text:u(r).join("")}}))??[]},active_toc_ids_array:t=>[...t.active_toc_ids],flatten_toc_links:()=>d,src_path:t=>{var r;let e=((r=t.nullable_article)==null?void 0:r._path)||"";return e.startsWith("/")&&(e=e.slice(1)),e?"src/content/"+e:"src/content"}},actions:{set_article(t){this.nullable_article=t||null,this.active_toc_ids.clear()},set_prev(t){this.prev=t||null},set_next(t){this.next=t||null},sync_article(t){this.set_article(t==null?void 0:t.article)},sync_surround(t){var e,r;this.set_prev((e=t==null?void 0:t.surround)==null?void 0:e[0]),this.set_next((r=t==null?void 0:t.surround)==null?void 0:r[1])},set_active_toc_id(t){this.active_toc_ids.clear(),this.active_toc_ids.add(t.id)}}});export{s as a,D as u};
