import{H as c,I as o,c as u}from"./BySKBGP4.js";import{p as d,v as h}from"./DaSufskL.js";const s=c({id:"current_url",state:()=>({route_path:null}),getters:{path:t=>d(t.route_path||""),prefix:t=>{var e;return"/"+(((e=t.route_path)==null?void 0:e.split("/").at(1))??"")}},actions:{sync_route(){const{path:t}=o();this.route_path=t},validate_url(t){h(t,this.path)}}});function p(t,e=500){if(!t)throw u({statusCode:Math.floor(e),statusMessage:`invaild article type: ${typeof t}`});return t}const f=/\d{4}-[01]{1}\d{1}-[0-3]{1}\d{1}/,x=t=>{var e;return t=(e=t.match(f))==null?void 0:e.at(0)},i=["h1","h2","h3","h4","h5"],a=(t,e)=>e?(e.endsWith("/")||(e=e+"/"),t?e.startsWith("/")?t+e:t+"/"+e:e):"",l=t=>t.map(e=>{let r=[e];if(e.children){const n=l(e.children);r=[e,...n]}return r}).flat(1),_=t=>{if(!t.children)return[];let e=[];for(const r of t.children){if(r.type==="text"){e=[...e,r.value];continue}e=[...e,..._(r)]}return e},y=c({id:"current_article",state:()=>({nullable_article:null,prev:null,next:null,active_toc_ids:new Set}),getters:{article:t=>p(t.nullable_article),date:t=>{var e;return x(((e=t.nullable_article)==null?void 0:e.date)||"")},title:t=>{var e;return((e=t.nullable_article)==null?void 0:e.title)||""},tags:t=>{var e;return((e=t.nullable_article)==null?void 0:e.tags)||[]},description:t=>{var e;return((e=t.nullable_article)==null?void 0:e.description)||""},prev_path:t=>{var r;const e=s();return a(e.prefix,(r=t.prev)==null?void 0:r._path)},next_path:t=>{var r;const e=s();return a(e.prefix,(r=t.next)==null?void 0:r._path)},toc_tags:()=>i,toc_links:t=>{var e;return((e=t.nullable_article)==null?void 0:e.body.children.filter(r=>i.indexOf(r.tag??"")>=0).map(r=>{var n;return{id:(n=r.props)==null?void 0:n.id,depth:i.indexOf(r.tag??"")+1,text:_(r).join("")}}))??[]},active_toc_ids_array:t=>[...t.active_toc_ids],flatten_toc_links:()=>l,src_path:t=>{var r;let e=((r=t.nullable_article)==null?void 0:r._path)||"";return e.startsWith("/")&&(e=e.slice(1)),e?"src/content/"+e:"src/content"}},actions:{set_article(t){this.nullable_article=t||null,this.active_toc_ids.clear()},set_prev(t){this.prev=t||null},set_next(t){this.next=t||null},sync_article(t){this.set_article(t==null?void 0:t.article)},sync_surround(t){var e,r;this.set_prev((e=t==null?void 0:t.surround)==null?void 0:e[0]),this.set_next((r=t==null?void 0:t.surround)==null?void 0:r[1])},set_active_toc_id(t){this.active_toc_ids.clear(),this.active_toc_ids.add(t.id)}}});export{s as a,y as u};
