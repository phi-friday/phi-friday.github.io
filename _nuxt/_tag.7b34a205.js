import{a as R,a1 as W,o as i,b as _,h as f,w as L,e,B as C,u as s,ac as S,ad as z,k as D,ag as E,a9 as j,l as T,t as F,y as H,aa as G,ap as K,i as M,F as O,ae as Q,H as U,x as $,R as X,ah as Y,J as Z}from"./entry.15fe0398.js";import{_ as P}from"./one.vue.e647f383.js";import{_ as tt}from"./pagination.a4d20b17.js";import{u as et,q as at}from"./query.e0f49c67.js";import{g as st}from"./query.f5aceab6.js";import{r as nt}from"./data_type.9bdab8d3.js";/* empty css                       */import"./utils.6b1f6722.js";const ot={class:"wrapper"},rt={class:"text-2xl font-semibold"},lt={class:"flex-wrap article-tags"},ct={class:"font-mono text-sm font-thin text-slate-400"},it=R({__name:"item",props:{article:null,post_prefix:null,tag_prefix:null},setup(q){var y;const u=q,c=u.article,n=/\d{4}-[01]{1}\d{1}-[0-3]{1}\d{1}/;if(!n.test(c.date))throw W({statusCode:400,statusMessage:`invalid date string: ${c.date}`});const d=(y=c.date.match(n))==null?void 0:y.at(0),b=[...new Set(c.tags)].sort((t,g)=>t.localeCompare(g)),v=(t,g,r=void 0)=>{let o=r;return o||(g==="post"?o=u.post_prefix:o=u.tag_prefix),!t||!o?t??void 0:t.startsWith("/")?o+t:o+"/"+t};return(t,g)=>{const r=P,o=D;return i(),_("div",null,[f(o,{to:v(s(c)._path,"post")},{default:L(()=>[e("div",ot,[e("header",null,[e("h1",rt,C(s(c).title),1),e("p",null,C(s(c).description),1),e("ul",lt,[(i(!0),_(S,null,z(s(b),(k,l)=>(i(),_("div",{key:l},[f(r,{tag:k,add_tag:!0},null,8,["tag"])]))),128))]),e("p",ct," created at: "+C(s(d)),1)])])]),_:1},8,["to"])])}}}),_t={class:"mb-2"},ut={class:"flex row-span-1 row-start-1 gap-x-2"},dt=e("span",null," Reset",-1),pt=e("span",null,"Tags",-1),gt=R({__name:"select",props:{tag_data:null},setup(q){const u=q,c=O(),n=(l,p=void 0)=>l.map(x=>{let w=x;return x[p]&&(w=n(x[p])),w}).flat(1),d=E(),b=()=>{d.value.clear()},y=[...new Set(n(u.tag_data,"tags"))].filter(l=>typeof l=="string").sort((l,p)=>l.localeCompare(p)),t=j(),g=()=>{Q(!t.value,t)},r=T(),o=T(),k=()=>{var l,p;t.value?(l=r.value)==null||l.appendChild(o.value):(p=r.value)==null||p.removeChild(o.value)};return F(()=>k()),H(()=>t.value,()=>k()),(l,p)=>{const m=D,x=P;return i(),_(S,null,[e("div",_t,[e("div",ut,[e("div",{class:"cta w-icon",onClick:b},[f(m,{to:`${s(c).public.tag_prefix}`},{default:L(()=>[f(s(G),{class:"icon solid"}),dt]),_:1},8,["to"])]),e("button",{onClick:g,class:"cta w-icon"},[f(s(K),{class:"icon solid"}),pt])])]),e("div",{class:M(["tag-list",{active:s(t)}]),ref_key:"tag_parent_ref",ref:r},[e("ul",{class:"flex flex-wrap article-tags",ref_key:"tag_ref",ref:o},[(i(!0),_(S,null,z(s(y),(w,A)=>(i(),_("div",{key:A},[f(x,{class:"font-semibold",tag:w,add_tag:!0},null,8,["tag"])]))),128))],512)],2)],64)}}}),ft={class:"page-heading"},mt={class:"wrapper"},xt={class:"text-5xl font-extrabold"},ht={class:"page-section"},vt={key:0,class:"article-list"},yt={key:1},Nt=R({__name:"@tag",async setup(q){let u,c;const n=U(),d=O(),b=()=>{let a;return!n.query.page||Array.isArray(n.query.page)?a=1:a=Number(n.query.page),a||(a=1),a},v=d.public.default_limit,y=()=>{const a=b();return d.public.default_skip+v*(a-1)},t=T(),g=()=>{t.value=y()};g();const r=E(),o=$(()=>[...r.value].sort((a,h)=>a.localeCompare(h))),k=st(),{data:l}=([u,c]=X(()=>et("maybe_tagged_data",()=>at(k).only(["title","description","tags","_path","date"]).skip(d.public.default_skip).find())),u=await u,c(),u),p=nt(l),m=$(()=>p.value.filter(a=>{var h;return(h=a.tags)==null?void 0:h.length})),x=$(()=>{const a=r.value;return a.size===0?m.value.slice(t.value,t.value+v):m.value.filter(h=>[...new Set(h.tags)].filter(N=>a.has(N)).length==a.size).slice(t.value,t.value+v)});F(()=>{if(n.query.select&&!Array.isArray(n.query.select)){for(const a of m.value)if(a.tags&&a.tags.includes(n.query.select)){r.value.clear(),r.value.add(n.query.select);break}}}),H(()=>n.query,()=>{g()});const w=Y(),A=$(()=>`All tagged posts: ${w.value}`),B=$(()=>{if(r.value.size>0)return`Selected tags: ${o.value}`});return Z({title:`${d.public.name} - All tagged posts`,meta:[{hid:"description",name:"description",content:"All posts with tags"}]}),(a,h)=>{const N=gt,V=it,J=tt;return i(),_("main",null,[e("header",ft,[e("div",mt,[e("h1",xt,C(s(A)),1),e("p",{class:M(["text-lg font-medium",{"text-transparent":s(B)===null}])},C(s(B)||"â €"),3)])]),e("div",null,[e("section",ht,[f(N,{tag_data:s(m)},null,8,["tag_data"]),s(x).length>0?(i(),_("ul",vt,[(i(!0),_(S,null,z(s(x),I=>(i(),_("li",{key:I._path,class:"article-item"},[f(V,{article:I,post_prefix:s(d).public.post_prefix,tag_prefix:s(d).public.tag_prefix},null,8,["article","post_prefix","tag_prefix"])]))),128))])):(i(),_("p",yt,"No articles found."))]),f(J,{count_data:s(m),how:"tag"},null,8,["count_data"])])])}}});export{Nt as default};
