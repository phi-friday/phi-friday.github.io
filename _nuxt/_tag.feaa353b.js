import{a as z,$ as j,o as i,f as _,l as f,y as D,i as e,E as C,u as s,F as S,D as L,L as E,am as I,ah as G,r as T,H as P,N as F,ai as J,au as K,p as H,e as M,ak as Q,P as U,b as $,S as X,an as Y,a6 as Z}from"./entry.23441bf5.js";import{_ as O}from"./one.vue.24e77631.js";import{_ as tt}from"./pagination.4da94015.js";import{u as et}from"./asyncData.61a83d68.js";import{g as at}from"./query.f5aceab6.js";import{q as st}from"./query.fefdd155.js";import{r as nt}from"./data_type.9bdab8d3.js";/* empty css                       */import"./utils.828f2156.js";const ot={class:"wrapper"},rt={class:"text-2xl font-semibold"},lt={class:"flex-wrap article-tags"},ct={class:"font-mono text-sm font-thin text-slate-400"},it=z({__name:"item",props:{article:null,post_prefix:null,tag_prefix:null},setup(q){var y;const u=q,c=u.article,n=/\d{4}-[01]{1}\d{1}-[0-3]{1}\d{1}/;if(!n.test(c.date))throw j({statusCode:400,statusMessage:`invalid date string: ${c.date}`});const p=(y=c.date.match(n))==null?void 0:y.at(0),b=[...new Set(c.tags)].sort((t,g)=>t.localeCompare(g)),h=(t,g,r=void 0)=>{let o=r;return o||(g==="post"?o=u.post_prefix:o=u.tag_prefix),!t||!o?t??void 0:t.startsWith("/")?o+t:o+"/"+t};return(t,g)=>{const r=O,o=E;return i(),_("div",null,[f(o,{to:h(s(c)._path,"post")},{default:D(()=>[e("div",ot,[e("header",null,[e("h1",rt,C(s(c).title),1),e("p",null,C(s(c).description),1),e("ul",lt,[(i(!0),_(S,null,L(s(b),(k,l)=>(i(),_("div",{key:l},[f(r,{tag:k,add_tag:!0},null,8,["tag"])]))),128))]),e("p",ct," created at: "+C(s(p)),1)])])]),_:1},8,["to"])])}}}),_t={class:"mb-2"},ut={class:"flex row-span-1 row-start-1 gap-x-2"},pt=e("span",null," Reset",-1),dt=e("span",null,"Tags",-1),gt=z({__name:"select",props:{tag_data:null},setup(q){const u=q,c=M(),n=(l,d=void 0)=>l.map(x=>{let w=x;return x[d]&&(w=n(x[d])),w}).flat(1),p=I(),b=()=>{p.value.clear()},y=[...new Set(n(u.tag_data,"tags"))].filter(l=>typeof l=="string").sort((l,d)=>l.localeCompare(d)),t=G(),g=()=>{Q(!t.value,t)},r=T(),o=T(),k=()=>{var l,d;t.value?(l=r.value)==null||l.appendChild(o.value):(d=r.value)==null||d.removeChild(o.value)};return P(()=>k()),F(()=>t.value,()=>k()),(l,d)=>{const m=E,x=O;return i(),_(S,null,[e("div",_t,[e("div",ut,[e("div",{class:"cta w-icon",onClick:b},[f(m,{to:`${s(c).public.tag_prefix}`},{default:D(()=>[f(s(J),{class:"icon solid"}),pt]),_:1},8,["to"])]),e("button",{onClick:g,class:"cta w-icon"},[f(s(K),{class:"icon solid"}),dt])])]),e("div",{class:H(["tag-list",{active:s(t)}]),ref_key:"tag_parent_ref",ref:r},[e("ul",{class:"flex flex-wrap article-tags",ref_key:"tag_ref",ref:o},[(i(!0),_(S,null,L(s(y),(w,A)=>(i(),_("div",{key:A},[f(x,{class:"font-semibold",tag:w,add_tag:!0},null,8,["tag"])]))),128))],512)],2)],64)}}}),ft={class:"page-heading"},mt={class:"wrapper"},xt={class:"text-5xl font-extrabold"},vt={class:"page-section"},ht={key:0,class:"article-list"},yt={key:1},Tt=z({__name:"@tag",async setup(q){let u,c;const n=U(),p=M(),b=()=>{let a;return!n.query.page||Array.isArray(n.query.page)?a=1:a=Number(n.query.page),a||(a=1),a},h=p.public.default_limit,y=()=>{const a=b();return p.public.default_skip+h*(a-1)},t=T(),g=()=>{t.value=y()};g();const r=I(),o=$(()=>[...r.value].sort((a,v)=>a.localeCompare(v))),k=at(),{data:l}=([u,c]=X(()=>et("maybe_tagged_data",()=>st(k).only(["title","description","tags","_path","date"]).skip(p.public.default_skip).find())),u=await u,c(),u),d=nt(l),m=$(()=>d.value.filter(a=>{var v;return(v=a.tags)==null?void 0:v.length})),x=$(()=>{const a=r.value;return a.size===0?m.value.slice(t.value,t.value+h):m.value.filter(v=>[...new Set(v.tags)].filter(N=>a.has(N)).length==a.size).slice(t.value,t.value+h)});P(()=>{if(n.query.select&&!Array.isArray(n.query.select)){for(const a of m.value)if(a.tags&&a.tags.includes(n.query.select)){r.value.clear(),r.value.add(n.query.select);break}}}),F(()=>n.query,()=>{g()});const w=Y(),A=$(()=>`All tagged posts: ${w.value}`),R=$(()=>{if(r.value.size>0)return`Selected tags: ${o.value}`});return Z({title:`${p.public.name} - All tagged posts`,meta:[{hid:"description",name:"description",content:"All posts with tags"}]}),(a,v)=>{const N=gt,V=it,W=tt;return i(),_("main",null,[e("header",ft,[e("div",mt,[e("h1",xt,C(s(A)),1),e("p",{class:H(["text-lg font-medium",{"text-transparent":s(R)===null}])},C(s(R)||"â €"),3)])]),e("div",null,[e("section",vt,[f(N,{tag_data:s(m)},null,8,["tag_data"]),s(x).length>0?(i(),_("ul",ht,[(i(!0),_(S,null,L(s(x),B=>(i(),_("li",{key:B._path,class:"article-item"},[f(V,{article:B,post_prefix:s(p).public.post_prefix,tag_prefix:s(p).public.tag_prefix},null,8,["article","post_prefix","tag_prefix"])]))),128))])):(i(),_("p",yt,"No articles found."))]),f(W,{count_data:s(m),how:"tag"},null,8,["count_data"])])])}}});export{Tt as default};
