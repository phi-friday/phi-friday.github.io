import{_ as y}from"./NisPfvRt.js";import{f as u,y as d,v as o,g as m,o as r,c as g,q as b,w as k,d as w,t as _,h as n,n as S}from"./Dbe9OQSM.js";import{a as p}from"./Bp4vwyAx.js";const q=u({id:"current_page",state:()=>({nullable_page:null}),getters:{page:e=>e.nullable_page||1,skip:e=>o().public.default_limit*((e.nullable_page||1)-1)},actions:{sync_page_with_route(e){e||(e=d()),!e.query.page||Array.isArray(e.query.page)?this.nullable_page=1:this.nullable_page=Number(e.query.page),this.nullable_page||(this.nullable_page=1)},clear_page(){this.nullable_page=null}}}),C=u({id:"current_tags",state:()=>({tags:new Set,selected:new Set,count:new Map,posts:[],tagged_posts:[],toggle:!0}),getters:{sorted_tags:e=>[...e.tags].sort((t,s)=>t.localeCompare(s)),sorted_selected:e=>[...e.selected].sort((t,s)=>t.localeCompare(s)),sorted_by_count:e=>[...e.count.entries()].sort((t,s)=>t[1]<s[1]?1:t[1]>s[1]?-1:t[0].localeCompare(s[0])),selected_posts:e=>{const t=q(),s=o();if(e.selected.size===0)return[e.tagged_posts.length,e.tagged_posts.slice(t.skip,t.skip+s.public.default_limit)];const a=e.tagged_posts.filter(l=>new Set(l.tags).isSupersetOf(e.selected));return[a.length,a.slice(t.skip,t.skip+s.public.default_limit)]}},actions:{sync_posts(e){const t=new Map,s=e.filter(a=>{var l;return(l=a.tags)==null?void 0:l.length})||[];s.forEach(a=>{a.tags.forEach(l=>{t.set(l,(t.get(l)||0)+1)})}),this.tags=new Set(t.keys()),this.selected=new Set,this.count=new Map(t),this.posts=e,this.tagged_posts=s},add_tag(e){this.tags.has(e)&&this.selected.add(e)},remove_tag(e){this.selected.delete(e)},clear_selected(){this.selected.clear()},sync_selected_with_route(e){if(e||(e=d()),!!e.query.select){if(Array.isArray(e.query.select)){const t=new Set([...e.query.select]);this.selected=t.intersection(this.tags);return}this.tags.has(e.query.select)&&(this.selected=new Set([e.query.select]))}}}}),x={key:1},M=m({__name:"one",props:{tag:{},count:{},add_tag:{type:Boolean},do_select:{type:Boolean},use_link:{type:Boolean}},setup(e){const t=e,s=o(),a=C(),l=()=>{t.add_tag&&(a.selected.has(t.tag)?a.remove_tag(t.tag):a.add_tag(t.tag))};let c;t.do_select??!1?c={path:p(s.public.tag_prefix),query:{select:t.tag}}:c={path:p(s.public.tag_prefix)};const i=t.count??!1?`${t.tag} [${t.count}]`:t.tag;return(f,B)=>{const h=y;return r(),g("li",{class:S(["tag",{select:n(a).selected.has(t.tag)}]),onClick:l},[f.use_link?(r(),b(h,{key:0,to:n(c)},{default:k(()=>[w(_(n(i)),1)]),_:1},8,["to"])):(r(),g("div",x,_(n(i)),1))],2)}}});export{M as _,q as a,C as u};
