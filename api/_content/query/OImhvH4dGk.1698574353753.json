{"_path":"/python/http_client_vs","_dir":"python","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"requests vs httpx vs aiohttp, 뭐가 더 빠를까","description":"그냥 편한거 쓰는게 제일 나은거 같은데?","tags":["python","requests","httpx","aiohttp"],"date":"2023-04-24T14:35:48.171Z","publish":true,"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"각-라이브러리-간략한-소개"},"children":[{"type":"text","value":"각 라이브러리 간략한 소개"}]},{"type":"element","tag":"h3","props":{"id":"가장-범용적인-requests"},"children":[{"type":"text","value":"가장 범용적인 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"requests"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"python"}]},{"type":"text","value":"의 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"http"}]},{"type":"text","value":" 클라이언트 라이브러리 중 가장 유명하다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"requests"}]},{"type":"text","value":"는 워낙 많이 알려졌고, 사용하는 사람, 참조하는 라이브러리가 많다. 따라서 레퍼런스를 찾기 쉽고, 그만큼 배우기 쉽고, 사용하기도 쉽다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"동기 호출만"}]},{"type":"text","value":" 지원한다.. 따라서 여러 요청을 효율적으로 실행하려면 쓰레드가 필수적이다.("},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"greenlet"}]},{"type":"text","value":"은 예외적인 경우)"}]},{"type":"element","tag":"h3","props":{"id":"requests와-비슷한-httpx"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"requests"}]},{"type":"text","value":"와 비슷한 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"httpx"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"requests"}]},{"type":"text","value":"의 대부분의 api와 호환되도록 작성된 라이브러리."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"requests"}]},{"type":"text","value":"와 비슷하게 사용할 수 있어서 기존에 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"requests"}]},{"type":"text","value":"를 사용했다면 금방 적응할 수 있으며, "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"requests"}]},{"type":"text","value":"에 비해서 좀 더 나은 현대적인 기능과 타입힌트를 제공한다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"동기, 비동기 호출을 모두"}]},{"type":"text","value":" 지원한다."}]},{"type":"element","tag":"h3","props":{"id":"asyncio기반으로-처음-작성된-aiohttp"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"asyncio"}]},{"type":"text","value":"기반으로 처음 작성된 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"aiohttp"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"asyncio"}]},{"type":"text","value":" 프로젝트가 시작하고, "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"asyncio"}]},{"type":"text","value":"기반으로 가장 먼저 작성된 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"http"}]},{"type":"text","value":" 서버 및 클라이언트 라이브러리다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"실제로 써본적은 없고, 몇몇 사용기를 보면 가볍고 빠르다고 한다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"requests"}]},{"type":"text","value":"와 api와 호환되지 않아서 사용법을 잘 숙지할 필요가 있다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"비동기 호출만"}]},{"type":"text","value":" 지원한다."}]},{"type":"element","tag":"h2","props":{"id":"실제-사용된-각-테스트-코드"},"children":[{"type":"text","value":"실제 사용된 각 테스트 코드"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"모두 10개 세션을 유지하고 총 1000번 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"GET"}]},{"type":"text","value":" 요청을 실행했다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"httpx"}]},{"type":"text","value":"와 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"aiohttp"}]},{"type":"text","value":"는 비동기로 실행했고, "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"requests"}]},{"type":"text","value":"는 그냥 사용하면 상대가 되지 않기 때문에, 최대 10개 작업이 가능한 쓰레드 풀을 생성하여 실행했다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"정리하자면,"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"httpx"}]},{"type":"text","value":": 10개 세션, 1000개 요청, 비동기"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"aiohttp"}]},{"type":"text","value":": 10개 세션, 1000개 요청, 비동기"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"requests"}]},{"type":"text","value":": 10개 세션, 10개 쓰레드, 1000개 요청, 동기"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"당연하지만 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"requests"}]},{"type":"text","value":" 쓰레드가 10개라고 해서 각 쓰레드별 10개 세션을 가진건 아니다. 10개의 세션을 가진 풀에서 세션 객체를 각 쓰레드가 가져와서 사용하는 방식으로 진행했다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"모든 테스트는 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"python3.11"}]},{"type":"text","value":"에서 실시했으며, 하는김에 3.11에 새로 추가된 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"TaskGroup"}]},{"type":"text","value":"을 사용해봤다."}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"httpx"}]},{"type":"element","tag":"code","props":{"code":"from __future__ import annotations\n\nimport asyncio\nimport math\nimport time\nimport typing\nfrom contextlib import AsyncExitStack\n\nimport httpx\nimport uvloop\n\nCLIENT_COUNT = 10\nREQUEST_COUNT = 1000\nURL = \"https://jsonplaceholder.typicode.com/posts/1\"\nHEADER = {\n    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) \"\n    \"AppleWebKit/537.36 (KHTML, like Gecko) \"\n    \"Chrome/112.0.0.0 Safari/537.36\",\n}\nTIMEOUT = 10\n\n\nasync def _timer(\n    func: typing.Callable[..., typing.Coroutine[typing.Any, typing.Any, typing.Any]],\n    *args: typing.Any,\n    **kwargs: typing.Any,\n) -> typing.Any:\n    start = time.perf_counter()\n    result = await func(*args, **kwargs)\n    end = time.perf_counter()\n    return result, end - start\n\n\nasync def _request_one(client: httpx.AsyncClient) -> None:\n    response = await client.get(URL, headers=HEADER)\n    response.raise_for_status()\n\n\nasync def _enter_and_put_client(\n    stack: AsyncExitStack,\n    queue: asyncio.Queue[httpx.AsyncClient],\n) -> None:\n    client = await stack.enter_async_context(httpx.AsyncClient(timeout=TIMEOUT))\n    await queue.put(client)\n\n\nasync def _run_request(\n    queue: asyncio.Queue[httpx.AsyncClient],\n    timer_queue: asyncio.Queue[float],\n    semaphore: asyncio.Semaphore,\n) -> None:\n    async with semaphore:\n        client = await queue.get()\n        _, _time = await _timer(_request_one, client)\n    await timer_queue.put(_time)\n    await queue.put(client)\n\n\ndef _gen(queue: asyncio.Queue[float]) -> typing.Generator[float, None, None]:\n    while not queue.empty():\n        yield queue.get_nowait()\n\n\ndef _print_time(timer_queue: asyncio.Queue[float]) -> None:\n    time_result = list(_gen(timer_queue))\n    print(\n        \"sum={:.4f}, median={:.4f}, mean={:.4f}, std={:.4f}\".format(\n            sum(time_result),\n            sorted(time_result)[len(time_result) // 2],\n            (mean := sum(time_result) / len(time_result)),\n            math.sqrt(\n                sum(pow(x - mean, 2) for x in time_result) / len(time_result),\n            ),\n        ),\n    )\n\n\nasync def _request_many(client_count: int, request_count: int) -> None:\n    async with AsyncExitStack() as stack:\n        queue: asyncio.Queue[httpx.AsyncClient] = asyncio.Queue(client_count)\n        timer_queue: asyncio.Queue[float] = asyncio.Queue(request_count)\n        semaphore = asyncio.Semaphore(client_count)\n\n        async with asyncio.TaskGroup() as tg:\n            _ = [\n                tg.create_task(_enter_and_put_client(stack, queue))\n                for _ in range(client_count)\n            ]\n\n        async with asyncio.TaskGroup() as tg:\n            _ = [\n                tg.create_task(_run_request(queue, timer_queue, semaphore))\n                for _ in range(request_count)\n            ]\n        _print_time(timer_queue)\n\n\nasync def main() -> None:\n    _, _time = await _timer(_request_many, CLIENT_COUNT, REQUEST_COUNT)\n    print(f\"total={_time:.4f}\")\n\n\nif __name__ == \"__main__\":\n    uvloop.install()\n    asyncio.run(main())\n","filename":"test_httpx.py","language":"python","meta":"[test_httpx.py]"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"__future__"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" annotations"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" asyncio"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" math"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" time"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" typing"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" contextlib "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" AsyncExitStack"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" httpx"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" uvloop"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"CLIENT_COUNT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"10"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"REQUEST_COUNT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"1000"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"URL"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"https://jsonplaceholder.typicode.com/posts/1\""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"HEADER"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"User-Agent\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) \""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"AppleWebKit/537.36 (KHTML, like Gecko) \""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"Chrome/112.0.0.0 Safari/537.36\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"TIMEOUT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"10"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_timer"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    func: typing.Callable["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", typing.Coroutine[typing.Any, typing.Any, typing.Any]],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"args: typing.Any,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"**"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"kwargs: typing.Any,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":") -> typing.Any:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    start "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" time.perf_counter()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    result "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" func("}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"args, "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"**"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"kwargs)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    end "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" time.perf_counter()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" result, end "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" start"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_request_one"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(client: httpx.AsyncClient) -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    response "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" client.get("}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"URL"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-c0856a"},"children":[{"type":"text","value":"headers"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"HEADER"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    response.raise_for_status()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_enter_and_put_client"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    stack: AsyncExitStack,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    queue: asyncio.Queue[httpx.AsyncClient],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":") -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    client "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" stack.enter_async_context(httpx.AsyncClient("}]},{"type":"element","tag":"span","props":{"class":"ct-c0856a"},"children":[{"type":"text","value":"timeout"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"TIMEOUT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" queue.put(client)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_run_request"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    queue: asyncio.Queue[httpx.AsyncClient],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    timer_queue: asyncio.Queue["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    semaphore: asyncio.Semaphore,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":") -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" semaphore:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        client "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" queue.get()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        _, _time "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" _timer(_request_one, client)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" timer_queue.put(_time)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" queue.put(client)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_gen"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(queue: asyncio.Queue["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"]) -> typing.Generator["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"]:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"while"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"not"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" queue.empty():"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"yield"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" queue.get_nowait()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_print_time"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(timer_queue: asyncio.Queue["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"]) -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    time_result "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"list"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(_gen(timer_queue))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"print"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"sum="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":.4f"}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":", median="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":.4f"}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":", mean="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":.4f"}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":", std="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":.4f"}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":".format("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"sum"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"sorted"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result)["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result) "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"//"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            (mean "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"sum"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result) "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result)),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            math.sqrt("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"sum"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"pow"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(x "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" mean, "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" x "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" time_result) "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            ),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        ),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_request_many"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(client_count: "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", request_count: "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":") -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" AsyncExitStack() "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" stack:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        queue: asyncio.Queue[httpx.AsyncClient] "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" asyncio.Queue(client_count)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        timer_queue: asyncio.Queue["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" asyncio.Queue(request_count)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        semaphore "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" asyncio.Semaphore(client_count)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" asyncio.TaskGroup() "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" tg:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            _ "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" ["}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"                tg.create_task(_enter_and_put_client(stack, queue))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" _ "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"range"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(client_count)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            ]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" asyncio.TaskGroup() "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" tg:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            _ "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" ["}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"                tg.create_task(_run_request(queue, timer_queue, semaphore))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" _ "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"range"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(request_count)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            ]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        _print_time(timer_queue)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"main"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"() -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    _, _time "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" _timer(_request_many, "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"CLIENT_COUNT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"REQUEST_COUNT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"print"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"f"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"total="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"_time"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":.4f"}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"__name__"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"=="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"__main__\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    uvloop.install()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    asyncio.run(main())"}]}]}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"aiohttp"}]},{"type":"element","tag":"code","props":{"code":"from __future__ import annotations\n\nimport asyncio\nimport math\nimport time\nimport typing\nfrom contextlib import AsyncExitStack\n\nimport aiohttp\nimport uvloop\n\nCLIENT_COUNT = 10\nREQUEST_COUNT = 1000\nURL = \"https://jsonplaceholder.typicode.com/posts/1\"\nHEADER = {\n    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) \"\n    \"AppleWebKit/537.36 (KHTML, like Gecko) \"\n    \"Chrome/112.0.0.0 Safari/537.36\",\n}\nTIMEOUT = 10\n\n\nasync def _timer(\n    func: typing.Callable[..., typing.Coroutine[typing.Any, typing.Any, typing.Any]],\n    *args: typing.Any,\n    **kwargs: typing.Any,\n) -> typing.Any:\n    start = time.perf_counter()\n    result = await func(*args, **kwargs)\n    end = time.perf_counter()\n    return result, end - start\n\n\nasync def _request_one(client: aiohttp.ClientSession) -> None:\n    async with client.get(URL, headers=HEADER) as response:\n        response.raise_for_status()\n\n\nasync def _enter_and_put_client(\n    stack: AsyncExitStack,\n    queue: asyncio.Queue[aiohttp.ClientSession],\n) -> None:\n    client = await stack.enter_async_context(\n        aiohttp.ClientSession(timeout=aiohttp.ClientTimeout(total=TIMEOUT)),\n    )\n    await queue.put(client)\n\n\nasync def _run_request(\n    queue: asyncio.Queue[aiohttp.ClientSession],\n    timer_queue: asyncio.Queue[float],\n    semaphore: asyncio.Semaphore,\n) -> None:\n    async with semaphore:\n        client = await queue.get()\n        _, _time = await _timer(_request_one, client)\n    await timer_queue.put(_time)\n    await queue.put(client)\n\n\ndef _gen(queue: asyncio.Queue[float]) -> typing.Generator[float, None, None]:\n    while not queue.empty():\n        yield queue.get_nowait()\n\n\ndef _print_time(timer_queue: asyncio.Queue[float]) -> None:\n    time_result = list(_gen(timer_queue))\n    print(\n        \"sum={:.4f}, median={:.4f}, mean={:.4f}, std={:.4f}\".format(\n            sum(time_result),\n            sorted(time_result)[len(time_result) // 2],\n            (mean := sum(time_result) / len(time_result)),\n            math.sqrt(\n                sum(pow(x - mean, 2) for x in time_result) / len(time_result),\n            ),\n        ),\n    )\n\n\nasync def _request_many(client_count: int, request_count: int) -> None:\n    async with AsyncExitStack() as stack:\n        queue: asyncio.Queue[aiohttp.ClientSession] = asyncio.Queue(client_count)\n        timer_queue: asyncio.Queue[float] = asyncio.Queue(request_count)\n        semaphore = asyncio.Semaphore(client_count)\n\n        async with asyncio.TaskGroup() as tg:\n            _ = [\n                tg.create_task(_enter_and_put_client(stack, queue))\n                for _ in range(client_count)\n            ]\n\n        async with asyncio.TaskGroup() as tg:\n            _ = [\n                tg.create_task(_run_request(queue, timer_queue, semaphore))\n                for _ in range(request_count)\n            ]\n        _print_time(timer_queue)\n\n\nasync def main() -> None:\n    _, _time = await _timer(_request_many, CLIENT_COUNT, REQUEST_COUNT)\n    print(f\"total={_time:.4f}\")\n\n\nif __name__ == \"__main__\":\n    uvloop.install()\n    asyncio.run(main())\n","filename":"test_aiohttp.py","language":"python","meta":"[test_aiohttp.py]"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"__future__"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" annotations"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" asyncio"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" math"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" time"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" typing"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" contextlib "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" AsyncExitStack"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" aiohttp"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" uvloop"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"CLIENT_COUNT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"10"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"REQUEST_COUNT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"1000"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"URL"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"https://jsonplaceholder.typicode.com/posts/1\""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"HEADER"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"User-Agent\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) \""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"AppleWebKit/537.36 (KHTML, like Gecko) \""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"Chrome/112.0.0.0 Safari/537.36\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"TIMEOUT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"10"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_timer"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    func: typing.Callable["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", typing.Coroutine[typing.Any, typing.Any, typing.Any]],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"args: typing.Any,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"**"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"kwargs: typing.Any,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":") -> typing.Any:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    start "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" time.perf_counter()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    result "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" func("}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"args, "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"**"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"kwargs)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    end "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" time.perf_counter()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" result, end "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" start"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_request_one"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(client: aiohttp.ClientSession) -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" client.get("}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"URL"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-c0856a"},"children":[{"type":"text","value":"headers"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"HEADER"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" response:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        response.raise_for_status()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_enter_and_put_client"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    stack: AsyncExitStack,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    queue: asyncio.Queue[aiohttp.ClientSession],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":") -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    client "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" stack.enter_async_context("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        aiohttp.ClientSession("}]},{"type":"element","tag":"span","props":{"class":"ct-c0856a"},"children":[{"type":"text","value":"timeout"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"aiohttp.ClientTimeout("}]},{"type":"element","tag":"span","props":{"class":"ct-c0856a"},"children":[{"type":"text","value":"total"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"TIMEOUT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":")),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" queue.put(client)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_run_request"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    queue: asyncio.Queue[aiohttp.ClientSession],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    timer_queue: asyncio.Queue["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    semaphore: asyncio.Semaphore,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":") -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" semaphore:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        client "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" queue.get()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        _, _time "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" _timer(_request_one, client)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" timer_queue.put(_time)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" queue.put(client)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_gen"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(queue: asyncio.Queue["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"]) -> typing.Generator["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"]:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"while"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"not"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" queue.empty():"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"yield"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" queue.get_nowait()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_print_time"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(timer_queue: asyncio.Queue["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"]) -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    time_result "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"list"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(_gen(timer_queue))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"print"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"sum="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":.4f"}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":", median="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":.4f"}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":", mean="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":.4f"}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":", std="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":.4f"}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":".format("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"sum"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"sorted"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result)["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result) "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"//"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            (mean "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"sum"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result) "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result)),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            math.sqrt("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"sum"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"pow"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(x "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" mean, "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" x "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" time_result) "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            ),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        ),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_request_many"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(client_count: "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", request_count: "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":") -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" AsyncExitStack() "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" stack:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        queue: asyncio.Queue[aiohttp.ClientSession] "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" asyncio.Queue(client_count)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        timer_queue: asyncio.Queue["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" asyncio.Queue(request_count)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        semaphore "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" asyncio.Semaphore(client_count)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" asyncio.TaskGroup() "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" tg:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            _ "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" ["}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"                tg.create_task(_enter_and_put_client(stack, queue))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" _ "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"range"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(client_count)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            ]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" asyncio.TaskGroup() "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" tg:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            _ "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" ["}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"                tg.create_task(_run_request(queue, timer_queue, semaphore))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" _ "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"range"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(request_count)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            ]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        _print_time(timer_queue)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"async"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"main"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"() -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    _, _time "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"await"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" _timer(_request_many, "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"CLIENT_COUNT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"REQUEST_COUNT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"print"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"f"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"total="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"_time"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":.4f"}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"__name__"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"=="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"__main__\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    uvloop.install()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    asyncio.run(main())"}]}]}]}]}]}]},{"type":"text","value":"\n\n"},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"requests"}]},{"type":"element","tag":"code","props":{"code":"from __future__ import annotations\n\nimport math\nimport time\nimport typing\nfrom queue import Queue\nfrom threading import Semaphore\n\nimport requests\nfrom joblib import Parallel, delayed\n\nCLIENT_COUNT = 10\nREQUEST_COUNT = 1000\nURL = \"https://jsonplaceholder.typicode.com/posts/1\"\nHEADER = {\n    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) \"\n    \"AppleWebKit/537.36 (KHTML, like Gecko) \"\n    \"Chrome/112.0.0.0 Safari/537.36\",\n}\nTIMEOUT = 10\n\n\ndef _timer(\n    func: typing.Callable[..., typing.Any],\n    *args: typing.Any,\n    **kwargs: typing.Any,\n) -> typing.Any:\n    start = time.perf_counter()\n    result = func(*args, **kwargs)\n    end = time.perf_counter()\n    return result, end - start\n\n\ndef _request_one(client: requests.Session) -> None:\n    response = client.get(URL, headers=HEADER, timeout=TIMEOUT)\n    response.raise_for_status()\n\n\ndef _run_request(\n    queue: Queue[requests.Session],\n    timer_queue: Queue[float],\n    semaphore: Semaphore,\n) -> None:\n    with semaphore:\n        client = queue.get()\n        _, _time = _timer(_request_one, client)\n    timer_queue.put_nowait(_time)\n    queue.put_nowait(client)\n\n\ndef _gen(queue: Queue[float]) -> typing.Generator[float, None, None]:\n    while not queue.empty():\n        yield queue.get_nowait()\n\n\ndef _print_time(timer_queue: Queue[float]) -> None:\n    time_result = list(_gen(timer_queue))\n    print(\n        \"sum={:.4f}, median={:.4f}, mean={:.4f}, std={:.4f}\".format(\n            sum(time_result),\n            sorted(time_result)[len(time_result) // 2],\n            (mean := sum(time_result) / len(time_result)),\n            math.sqrt(\n                sum(pow(x - mean, 2) for x in time_result) / len(time_result),\n            ),\n        ),\n    )\n\n\ndef _request_many(client_count: int, request_count: int) -> None:\n    semaphore = Semaphore(client_count)\n    queue: Queue[requests.Session] = Queue(maxsize=client_count)\n    timer_queue: Queue[float] = Queue(maxsize=request_count)\n    for _ in range(client_count):\n        queue.put_nowait(requests.Session())\n    delayed_run_request = delayed(_run_request)\n    with Parallel(n_jobs=client_count, backend=\"threading\", prefer=\"threads\") as pool:\n        _ = pool(\n            delayed_run_request(queue, timer_queue, semaphore)\n            for _ in range(request_count)\n        )\n    _print_time(timer_queue)\n\n\ndef main() -> None:\n    _, _time = _timer(_request_many, CLIENT_COUNT, REQUEST_COUNT)\n    print(f\"total={_time:.4f}\")\n\n\nif __name__ == \"__main__\":\n    main()\n","filename":"test_requests.py","language":"python","meta":"[test_requests.py]"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"__future__"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" annotations"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" math"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" time"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" typing"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" queue "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" Queue"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" threading "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" Semaphore"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" requests"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" joblib "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" Parallel, delayed"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"CLIENT_COUNT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"10"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"REQUEST_COUNT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"1000"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"URL"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"https://jsonplaceholder.typicode.com/posts/1\""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"HEADER"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"User-Agent\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) \""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"AppleWebKit/537.36 (KHTML, like Gecko) \""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"Chrome/112.0.0.0 Safari/537.36\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"TIMEOUT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"10"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_timer"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    func: typing.Callable["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", typing.Any],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"args: typing.Any,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"**"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"kwargs: typing.Any,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":") -> typing.Any:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    start "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" time.perf_counter()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    result "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" func("}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"args, "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"**"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"kwargs)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    end "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" time.perf_counter()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" result, end "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" start"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_request_one"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(client: requests.Session) -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    response "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" client.get("}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"URL"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-c0856a"},"children":[{"type":"text","value":"headers"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"HEADER"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-c0856a"},"children":[{"type":"text","value":"timeout"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"TIMEOUT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    response.raise_for_status()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_run_request"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    queue: Queue[requests.Session],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    timer_queue: Queue["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    semaphore: Semaphore,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":") -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" semaphore:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        client "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" queue.get()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        _, _time "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" _timer(_request_one, client)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    timer_queue.put_nowait(_time)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    queue.put_nowait(client)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_gen"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(queue: Queue["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"]) -> typing.Generator["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"]:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"while"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"not"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" queue.empty():"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"yield"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" queue.get_nowait()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_print_time"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(timer_queue: Queue["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"]) -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    time_result "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"list"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(_gen(timer_queue))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"print"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"sum="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":.4f"}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":", median="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":.4f"}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":", mean="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":.4f"}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":", std="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":.4f"}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":".format("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"sum"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"sorted"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result)["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result) "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"//"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            (mean "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"sum"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result) "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result)),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            math.sqrt("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"sum"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"pow"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(x "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" mean, "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" x "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" time_result) "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(time_result),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            ),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        ),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"_request_many"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(client_count: "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", request_count: "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":") -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    semaphore "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" Semaphore(client_count)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    queue: Queue[requests.Session] "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" Queue("}]},{"type":"element","tag":"span","props":{"class":"ct-c0856a"},"children":[{"type":"text","value":"maxsize"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"client_count)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    timer_queue: Queue["}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" Queue("}]},{"type":"element","tag":"span","props":{"class":"ct-c0856a"},"children":[{"type":"text","value":"maxsize"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"request_count)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" _ "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"range"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(client_count):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        queue.put_nowait(requests.Session())"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    delayed_run_request "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" delayed(_run_request)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" Parallel("}]},{"type":"element","tag":"span","props":{"class":"ct-c0856a"},"children":[{"type":"text","value":"n_jobs"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"client_count, "}]},{"type":"element","tag":"span","props":{"class":"ct-c0856a"},"children":[{"type":"text","value":"backend"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"threading\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-c0856a"},"children":[{"type":"text","value":"prefer"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"threads\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" pool:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        _ "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" pool("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            delayed_run_request(queue, timer_queue, semaphore)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" _ "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"range"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"(request_count)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"        )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    _print_time(timer_queue)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-57050c"},"children":[{"type":"text","value":"main"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"() -> "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    _, _time "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" _timer(_request_many, "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"CLIENT_COUNT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"REQUEST_COUNT"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"print"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"f"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"total="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"_time"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":":.4f"}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"__name__"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"=="}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":"\"__main__\""}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"    main()"}]}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"테스트-결과"},"children":[{"type":"text","value":"테스트 결과"}]},{"type":"element","tag":"code","props":{"code":"❯ .../.venv/bin/python .../test_httpx.py\nsum=42.3378, median=0.0412, mean=0.0423, std=0.0092\ntotal=4.4529\n❯ .../.venv/bin/python .../test_aiohttp.py\nsum=41.7602, median=0.0390, mean=0.0418, std=0.0132\ntotal=4.2363\n❯ .../.venv/bin/python .../test_requests.py\nsum=44.8297, median=0.0414, mean=0.0448, std=0.0279\ntotal=4.5194\n","language":"shell","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c0856a"},"children":[{"type":"text","value":"❯"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":".../.venv/bin/python"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":".../test_httpx.py"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"sum"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"42.3378"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" median"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"0.0412"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" mean"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"0.0423"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" std"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"0.0092"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"total"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"4.4529"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c0856a"},"children":[{"type":"text","value":"❯"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":".../.venv/bin/python"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":".../test_aiohttp.py"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"sum"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"41.7602"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" median"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"0.0390"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" mean"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"0.0418"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" std"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"0.0132"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"total"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"4.2363"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-c0856a"},"children":[{"type":"text","value":"❯"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":".../.venv/bin/python"}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":".../test_requests.py"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"sum"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"44.8297"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" median"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"0.0414"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" mean"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"0.0448"}]},{"type":"element","tag":"span","props":{"class":"ct-d950ae"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":" std"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"0.0279"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-2fabea"},"children":[{"type":"text","value":"total"}]},{"type":"element","tag":"span","props":{"class":"ct-4c06df"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-934349"},"children":[{"type":"text","value":"4.5194"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"기대와는-다른-결과"},"children":[{"type":"text","value":"기대와는 다른 결과"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"기대와는 전혀 다른 결과가 나왔다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"뭔가 뚜렷한 차이가 있을 것 같았지만, 셋 다 거기서 거기다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"혹시 실제로는 요청이 실행되지 않은건 아닌가 하고 확인해봤지만 정상이다."}]},{"type":"element","tag":"h3","props":{"id":"내가-뭔가-잘못-작성한-것-같다"},"children":[{"type":"text","value":"내가 뭔가 잘못 작성한 것 같다"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"del","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"aiohttp"}]},{"type":"text","value":"에 익숙하지 않은 점과, 공통된 방식으로 요청을 실행하고자 욕심부린 것 때문에 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"http"}]},{"type":"text","value":" 요청과는 무관한 지점에서 지연이 발생하지 않았을까."}]}]},{"type":"element","tag":"alert","props":{"type":"info"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"다시 측정해보면서 실제 요청에 대해서 집계를 해봤는데 정말 별 차이가 없다"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"다음에 다시한번 시도해보자"}]},{"type":"element","tag":"h2","props":{"id":"어쨌든-나는-httpx를-사용한다"},"children":[{"type":"text","value":"어쨌든 나는 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"httpx"}]},{"type":"text","value":"를 사용한다"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"위 테스트가 정상적으로 실행 된 것이라는 가정 하에,"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"별 성능 차이가 없다면 동기, 비동기 모두 지원하고,\n동기 비동기간 동일한 형태의 api로 사용할 수 있는 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"httpx"}]},{"type":"text","value":"가 가장 편하게 느껴진다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"아마 특별한 일이 없다면 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"httpx"}]},{"type":"text","value":"를 계속 사용하지 않을까."}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-c0856a{color:#953800}\n.ct-57050c{color:#8250DF}\n.ct-d950ae{color:#0A3069}\n.ct-934349{color:#0550AE}\n.ct-2fabea{color:#24292F}\n.ct-4c06df{color:#CF222E}\n.dark .ct-4c06df{color:#FF7B72}\n.dark .ct-2fabea{color:#C9D1D9}\n.dark .ct-934349{color:#79C0FF}\n.dark .ct-d950ae{color:#A5D6FF}\n.dark .ct-57050c{color:#D2A8FF}\n.dark .ct-c0856a{color:#FFA657}"}]}],"toc":{"title":"","searchDepth":5,"depth":5,"links":[{"id":"각-라이브러리-간략한-소개","depth":2,"text":"각 라이브러리 간략한 소개","children":[{"id":"가장-범용적인-requests","depth":3,"text":"가장 범용적인 requests"},{"id":"requests와-비슷한-httpx","depth":3,"text":"requests와 비슷한 httpx"},{"id":"asyncio기반으로-처음-작성된-aiohttp","depth":3,"text":"asyncio기반으로 처음 작성된 aiohttp"}]},{"id":"실제-사용된-각-테스트-코드","depth":2,"text":"실제 사용된 각 테스트 코드"},{"id":"테스트-결과","depth":2,"text":"테스트 결과","children":[{"id":"기대와는-다른-결과","depth":3,"text":"기대와는 다른 결과"},{"id":"내가-뭔가-잘못-작성한-것-같다","depth":3,"text":"내가 뭔가 잘못 작성한 것 같다"}]},{"id":"어쨌든-나는-httpx를-사용한다","depth":2,"text":"어쨌든 나는 httpx를 사용한다"}]}},"_type":"markdown","_id":"content:python:http_client_vs.md","_source":"content","_file":"python/http_client_vs.md","_extension":"md"}