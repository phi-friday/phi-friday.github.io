{"_path":"/python/airflow1","_dir":"python","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"새로운 문법으로 Airflow DAG 생성하기","description":"TaskFlow API를 사용하자","tags":["python","airflow"],"date":"2023-09-17T11:53:22.051Z","publish":true,"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"아직도-이렇게-dag을-생성해"},"children":[{"type":"text","value":"아직도 이렇게 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"DAG"}]},{"type":"text","value":"을 생성해?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"많은 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"airflow"}]},{"type":"text","value":" 관련 문서에서 다음과 같이 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"DAG"}]},{"type":"text","value":"을 생성한다."}]},{"type":"element","tag":"code","props":{"code":"from __future__ import annotations\n\nimport json\n\nimport pendulum\nfrom airflow import DAG\nfrom airflow.models.param import Param\nfrom airflow.operators.python import PythonOperator\n\nwith DAG(\n    \"tutorial_dag\",\n    schedule=None,\n    start_date=pendulum.datetime(2021, 1, 1, tz=\"UTC\"),\n    params={\n        \"tic\": Param(1, type=\"integer\"),\n        \"toc\": Param(2, type=\"integer\"),\n    },\n    catchup=False,\n    tags=[\"example\"],\n) as dag:\n\n    def extract(**kwargs) -> None:\n        ti = kwargs[\"ti\"]\n        params = kwargs[\"params\"]\n        data_string = (\n            f'{{\"1001\": {301.27 + params[\"tic\"]}, \"1002\": 433.21, \"1003\": 502.22}}'\n        )\n        ti.xcom_push(\"order_data\", data_string)\n\n    def transform(**kwargs) -> None:\n        ti = kwargs[\"ti\"]\n        extract_data_string = ti.xcom_pull(\n            task_ids=\"extract\",\n            key=\"order_data\",\n        )\n        order_data = json.loads(extract_data_string)\n\n        total_order_value = 0\n        for value in order_data.values():\n            total_order_value += value\n\n        total_value = {\"total_order_value\": total_order_value}\n        total_value_json_string = json.dumps(total_value)\n        ti.xcom_push(\"total_order_value\", total_value_json_string)\n\n    def load(**kwargs) -> None:\n        ti = kwargs[\"ti\"]\n        params = kwargs[\"params\"]\n        total_value_string = ti.xcom_pull(\n            task_ids=\"transform\",\n            key=\"total_order_value\",\n        )\n        total_order_value = json.loads(total_value_string)\n        total_order_value += params[\"toc\"]\n\n        print(total_order_value)\n\n    extract_task = PythonOperator(\n        task_id=\"extract\",\n        python_callable=extract,\n    )\n    transform_task = PythonOperator(\n        task_id=\"transform\",\n        python_callable=transform,\n    )\n    load_task = PythonOperator(\n        task_id=\"load\",\n        python_callable=load,\n    )\n    extract_task >> transform_task >> load_task\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"__future__"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" annotations"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" json"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" pendulum"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" airflow "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"DAG"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" airflow.models.param "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" Param"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" airflow.operators.python "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" PythonOperator"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" DAG("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"tutorial_dag\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"schedule"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"start_date"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"pendulum.datetime("}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"2021"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"tz"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"UTC\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"params"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"tic\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":": Param("}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"type"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"integer\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"toc\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":": Param("}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"type"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"integer\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    },"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"catchup"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"False"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"tags"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"example\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" dag:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-a50b3c"},"children":[{"type":"text","value":"extract"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"**"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"kwargs) -> "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        ti "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" kwargs["}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"ti\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        params "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" kwargs["}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"params\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        data_string "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" ("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"f"}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"{{"}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"1001\": "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"{301.27"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" params["}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"tic\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":", \"1002\": 433.21, \"1003\": 502.22"}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"}}"}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"'"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        ti.xcom_push("}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"order_data\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":", data_string)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-a50b3c"},"children":[{"type":"text","value":"transform"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"**"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"kwargs) -> "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        ti "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" kwargs["}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"ti\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        extract_data_string "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" ti.xcom_pull("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"task_ids"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"extract\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"key"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"order_data\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        order_data "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" json.loads(extract_data_string)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        total_order_value "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"0"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" value "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" order_data.values():"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"            total_order_value "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" value"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        total_value "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" {"}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"total_order_value\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":": total_order_value}"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        total_value_json_string "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" json.dumps(total_value)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        ti.xcom_push("}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"total_order_value\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":", total_value_json_string)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-a50b3c"},"children":[{"type":"text","value":"load"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"**"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"kwargs) -> "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        ti "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" kwargs["}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"ti\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        params "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" kwargs["}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"params\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        total_value_string "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" ti.xcom_pull("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"task_ids"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"transform\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"key"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"total_order_value\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        total_order_value "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" json.loads(total_value_string)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        total_order_value "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" params["}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"toc\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"print"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"(total_order_value)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    extract_task "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" PythonOperator("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"task_id"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"extract\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"python_callable"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"extract,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    transform_task "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" PythonOperator("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"task_id"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"transform\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"python_callable"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"transform,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    load_task "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" PythonOperator("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"task_id"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"load\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"python_callable"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"load,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    extract_task "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":">>"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" transform_task "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":">>"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" load_task"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"위 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"DAG"}]},{"type":"text","value":"이 하는 일은 단순하다."}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"extract"}]},{"type":"text","value":": 데이터를 생성한다."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"transform"}]},{"type":"text","value":": "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"extract"}]},{"type":"text","value":"에서 생성한 값을 변환한다."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"load"}]},{"type":"text","value":": "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"transform"}]},{"type":"text","value":"에서 생성한 값을 표준 출력에 출력한다."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"아주 간단한 작업이지만, 중복된 코드로 인해 스크립트가 길어졌다.\n작업이 늘어나고, 복잡도가 올라갈 수록 DAG은 점점 더 읽기 힘들어진다."}]},{"type":"element","tag":"h2","props":{"id":"새로운-작성-방식-taskflow"},"children":[{"type":"text","value":"새로운 작성 방식 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"TaskFlow"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"앞서 작성한 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"DAG"}]},{"type":"text","value":"을, "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"TaskFlow"}]},{"type":"text","value":" 형태로 작성하면 다음과 같다."}]},{"type":"element","tag":"code","props":{"code":"from __future__ import annotations\n\nimport json\nfrom typing import Any\n\nimport pendulum\nfrom airflow.decorators import dag, task\n\n\n@dag(\n    schedule=None,\n    start_date=pendulum.datetime(2021, 1, 1, tz=\"UTC\"),\n    catchup=False,\n    tags=[\"example\"],\n)\ndef tutorial_dag(tic: int = 1, toc: int = 2) -> None:\n    @task.python()\n    def extract(tic: int) -> Any:\n        data_string = f'{{\"1001\": {301.27 + tic}, \"1002\": 433.21, \"1003\": 502.22}}'\n        return json.loads(data_string)\n\n    @task.python(multiple_outputs=True)\n    def transform(order_data_dict: dict[str, float]) -> dict[str, float]:\n        total_order_value = 0\n\n        for value in order_data_dict.values():\n            total_order_value += value\n\n        return {\"total_order_value\": total_order_value}\n\n    @task.python()\n    def load(toc: int, total_order_value: float) -> None:\n        total_order_value += toc\n        print(f\"Total order value is: {total_order_value:.2f}\")\n\n    order_data = extract(tic)\n    order_summary = transform(order_data)\n    load(toc, order_summary[\"total_order_value\"])\n\n\ntutorial_dag()\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"__future__"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" annotations"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" json"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" typing "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" Any"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" pendulum"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" airflow.decorators "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" dag, task"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a50b3c"},"children":[{"type":"text","value":"@dag"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"schedule"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"start_date"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"pendulum.datetime("}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"2021"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"tz"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"UTC\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"catchup"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"False"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"tags"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"example\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-a50b3c"},"children":[{"type":"text","value":"tutorial_dag"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"(tic: "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":", toc: "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":") -> "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a50b3c"},"children":[{"type":"text","value":"@task.python"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-a50b3c"},"children":[{"type":"text","value":"extract"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"(tic: "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":") -> Any:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        data_string "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"f"}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"{{"}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"1001\": "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"{301.27"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" tic"}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":", \"1002\": 433.21, \"1003\": 502.22"}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"}}"}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"'"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" json.loads(data_string)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a50b3c"},"children":[{"type":"text","value":"@task.python"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-149029"},"children":[{"type":"text","value":"multiple_outputs"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"True"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-a50b3c"},"children":[{"type":"text","value":"transform"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"(order_data_dict: dict["}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"]) -> dict["}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"]:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        total_order_value "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"0"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" value "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" order_data_dict.values():"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"            total_order_value "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" value"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" {"}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"total_order_value\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":": total_order_value}"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-a50b3c"},"children":[{"type":"text","value":"@task.python"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-a50b3c"},"children":[{"type":"text","value":"load"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"(toc: "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":", total_order_value: "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"float"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":") -> "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        total_order_value "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" toc"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"print"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"f"}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"Total order value is: "}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"total_order_value"}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":":.2f"}]},{"type":"element","tag":"span","props":{"class":"ct-3d0a1d"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    order_data "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" extract(tic)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    order_summary "}]},{"type":"element","tag":"span","props":{"class":"ct-6145c6"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":" transform(order_data)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"    load(toc, order_summary["}]},{"type":"element","tag":"span","props":{"class":"ct-8123f8"},"children":[{"type":"text","value":"\"total_order_value\""}]},{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"])"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-bcfa76"},"children":[{"type":"text","value":"tutorial_dag()"}]}]}]}]}]},{"type":"element","tag":"alert","props":{"type":"info"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"TaskFlow"}]},{"type":"text","value":"는 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"airflow>=2.0.0"}]},{"type":"text","value":"부터 사용할 수 있다."}]}]},{"type":"element","tag":"alert","props":{"type":"info"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"airflow>=2.4.0"}]},{"type":"text","value":"부터 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"from airflow import DAG"}]},{"type":"text","value":"이 없어도 dag을 인식한다."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"훨씬 간결하고, 읽기 쉬워졌다.\n"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"XComArg"}]},{"type":"text","value":"를 사용하여 직접 변수를 사용할 수 있고, "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"params"}]},{"type":"text","value":"를 따로 정의하지 않아도, 알아서 추론하여 사용할 수 있게 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"DAG"}]},{"type":"text","value":"을 생성한다."}]},{"type":"element","tag":"alert","props":{"type":"info"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"params"}]},{"type":"text","value":"로 직접 정의하지 않은 경우, 런타임중 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"DagParam"}]},{"type":"text","value":"으로 치환되며, 실제 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Task"}]},{"type":"text","value":"가 실행될 때 값으로 치환된다."}]}]},{"type":"element","tag":"alert","props":{"type":"warning"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"간단하지 않은 스키마를 가진 경우에는 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"json"}]},{"type":"text","value":" 스키마로 기존 문법과 같이 사용한다."}]}]},{"type":"element","tag":"h2","props":{"id":"모든-operator를-바꿀-수는-없다"},"children":[{"type":"text","value":"모든 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Operator"}]},{"type":"text","value":"를 바꿀 수는 없다"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"아쉽게도 모든 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Operator"}]},{"type":"text","value":"에 대응하지는 않는다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"PythonOperator"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"PythonVirtualenvOperator"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"ExternalPythonOperator"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"BranchPythonOperator"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"ShortCircuitOperator"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"PythonSensor"}]},{"type":"text","value":"에 대응하는 데코레이터는 기본 제공하고 있지만, 그 외에는 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"provider"}]},{"type":"text","value":" 라이브러리에서 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"decorator"}]},{"type":"text","value":"모듈을 제공하고 있는 경우에 사용할 수 있다."}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-a50b3c{color:#8250DF}\n.ct-149029{color:#953800}\n.ct-8123f8{color:#0A3069}\n.ct-3d0a1d{color:#0550AE}\n.ct-bcfa76{color:#24292F}\n.ct-6145c6{color:#CF222E}\n.dark .ct-6145c6{color:#FF7B72}\n.dark .ct-bcfa76{color:#C9D1D9}\n.dark .ct-3d0a1d{color:#79C0FF}\n.dark .ct-8123f8{color:#A5D6FF}\n.dark .ct-149029{color:#FFA657}\n.dark .ct-a50b3c{color:#D2A8FF}"}]}],"toc":{"title":"","searchDepth":5,"depth":5,"links":[{"id":"아직도-이렇게-dag을-생성해","depth":2,"text":"아직도 이렇게 DAG을 생성해?"},{"id":"새로운-작성-방식-taskflow","depth":2,"text":"새로운 작성 방식 TaskFlow"},{"id":"모든-operator를-바꿀-수는-없다","depth":2,"text":"모든 Operator를 바꿀 수는 없다"}]}},"_type":"markdown","_id":"content:python:airflow1.md","_source":"content","_file":"python/airflow1.md","_extension":"md"}