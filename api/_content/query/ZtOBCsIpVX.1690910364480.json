{"_path":"/python/why_sqlachemy2","_dir":"python","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"sqlalchemy2.0는 무엇이 달라졌고, 왜 써야할까.","description":"더 빠르고 정확해진 orm","tags":["python","orm","sqlalchemy"],"date":"2023-03-18","publish":true,"body":{"type":"root","children":[{"type":"element","tag":"alert","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://docs.sqlalchemy.org/en/20/changelog/whatsnew_20.html","rel":["nofollow"]},"children":[{"type":"text","value":"What’s New in SQLAlchemy 2.0?"}]},{"type":"text","value":" 에서 필요하다 생각되는 내용을 각색해서 작성한 글입니다."}]}]},{"type":"element","tag":"h2","props":{"id":"1-pep-484-지원"},"children":[{"type":"text","value":"1. PEP-484 지원"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"기존의 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"sqlalchemy"}]},{"type":"text","value":"는 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"sqlalchemy2-stubs"}]},{"type":"text","value":"를 사용해서 타입 힌트를 제공했지만, 완전하지 않았습니다. 하지만 2.0에서는 이와 관련하여 유형이 있는 모든 요소에 대해 재작업되어, 선언부터 결과까지 확장됩니다. 실제 코드로 확인해봅시다."}]},{"type":"element","tag":"code","props":{"code":"import sqlalchemy as sa\n\nengine = sa.create_engine(sa.make_url(\"sqlite://\"))\n\nstr_col = sa.column(\"a\", sa.String)  # ColumnClause[str]\nint_col = sa.column(\"a\", sa.Integer)  # ColumnClause[int]\n\nexpr1 = str_col + \"x\"  # ColumnElement[str]\nexpr2 = int_col + 10  # ColumnElement[int]\nexpr3 = int_col == 15  # ColumnElement[bool]\n\n# Select[Tuple[str, int]]\nselect_stmt = sa.select(str_col, int_col)\n# ReturningInsert[Tuple[str, int]]\ninsert_stmt = sa.insert(sa.table(\"t\")).returning(str_col, int_col)\n\nwith engine.connect() as conn:\n    # CursorResult[Tuple[str, int]]\n    result = conn.execute(select_stmt)\n    # Row[Tuple[str, int]] | None\n    row = result.first()\n\n    if row is not None:\n        # str, int = Tuple[str, int]\n        str_val, int_val = row.tuple()\n\n    # Sequence[str]\n    data = conn.execute(sa.select(str_col)).scalars().all()\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sqlalchemy "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sa"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"engine "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sa.create_engine(sa.make_url("}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"sqlite://\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"str_col "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sa.column("}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"a\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", sa.String)  "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# ColumnClause[str]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"int_col "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sa.column("}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"a\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", sa.Integer)  "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# ColumnClause[int]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"expr1 "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" str_col "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"x\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# ColumnElement[str]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"expr2 "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" int_col "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"10"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# ColumnElement[int]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"expr3 "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" int_col "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"=="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"15"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# ColumnElement[bool]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# Select[Tuple[str, int]]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"select_stmt "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sa.select(str_col, int_col)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# ReturningInsert[Tuple[str, int]]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"insert_stmt "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sa.insert(sa.table("}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"t\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":")).returning(str_col, int_col)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" engine.connect() "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" conn:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# CursorResult[Tuple[str, int]]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    result "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" conn.execute(select_stmt)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# Row[Tuple[str, int]] | None"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    row "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" result.first()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" row "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"is"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"not"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# str, int = Tuple[str, int]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        str_val, int_val "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" row.tuple()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# Sequence[str]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    data "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" conn.execute(sa.select(str_col)).scalars().all()"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"이러한 점은 선언적 모델 정의에서도 잘 확인할 수 있습니다."}]},{"type":"element","tag":"code","props":{"code":"from __future__ import annotations\n\nimport sqlalchemy as sa\nfrom sqlalchemy.orm import (\n    DeclarativeBase,\n    Mapped,\n    Session,\n    aliased,\n    mapped_column,\n    relationship,\n)\n\nengine = sa.create_engine(sa.make_url(\"sqlite://\"))\n\n\nclass Base(DeclarativeBase):\n    ...\n\n\nclass User(Base):\n    __tablename__ = \"user_account\"\n\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    addresses: Mapped[list[Address]] = relationship()\n\n\nclass Address(Base):\n    __tablename__ = \"address\"\n\n    id: Mapped[int] = mapped_column(primary_key=True)\n    email_address: Mapped[str]\n    user_id = mapped_column(sa.ForeignKey(\"user_account.id\"))\n\n\nwith Session(engine) as session:\n    # Select[Tuple[User, Address]]\n    stmt = sa.select(User, Address).join_from(User, Address)\n    # Result[Tuple[User, Address]]\n    result = session.execute(stmt)\n    # User, Address = Tuple[User, Address]\n    user, adderss = result.one().tuple()\n\n    aliased_user = aliased(User)  # Type[User]\n    # Select[Tuple[User, User, str]]\n    stmt = sa.select(User, aliased_user, User.name).where(User.id == 5)\n    # Result[Tuple[User, User, str]]\n    result = session.execute(stmt)\n\n    # User\n    user = (\n        session.execute(\n            sa.select(User).limit(1),\n        )\n        .scalars()\n        .one()\n    )\n    # Sequence[User]\n    users = (\n        session.execute(\n            sa.select(User),\n        )\n        .scalars()\n        .all()\n    )\n    # Iterator[User]\n    user_iter = iter(\n        session.execute(\n            sa.select(User),\n        ).scalars(),\n    )\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"__future__"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" annotations"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sqlalchemy "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sa"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sqlalchemy.orm "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" ("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    DeclarativeBase,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    Mapped,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    Session,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    aliased,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    mapped_column,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    relationship,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"engine "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sa.create_engine(sa.make_url("}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"sqlite://\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"Base"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"DeclarativeBase"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"..."}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"User"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"Base"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    __tablename__ "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"user_account\""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"id"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": Mapped["}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" mapped_column("}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"primary_key"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"True"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    name: Mapped["}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    addresses: Mapped[list[Address]] "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" relationship()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"Address"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"Base"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    __tablename__ "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"address\""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"id"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": Mapped["}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" mapped_column("}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"primary_key"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"True"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    email_address: Mapped["}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    user_id "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" mapped_column(sa.ForeignKey("}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"user_account.id\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"with"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" Session(engine) "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" session:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# Select[Tuple[User, Address]]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    stmt "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sa.select(User, Address).join_from(User, Address)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# Result[Tuple[User, Address]]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    result "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" session.execute(stmt)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# User, Address = Tuple[User, Address]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    user, adderss "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" result.one().tuple()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    aliased_user "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" aliased(User)  "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# Type[User]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# Select[Tuple[User, User, str]]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    stmt "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sa.select(User, aliased_user, User.name).where(User.id "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"=="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"5"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# Result[Tuple[User, User, str]]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    result "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" session.execute(stmt)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# User"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    user "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" ("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        session.execute("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"            sa.select(User).limit("}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        .scalars()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        .one()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# Sequence[User]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    users "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" ("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        session.execute("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"            sa.select(User),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        .scalars()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        .all()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# Iterator[User]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    user_iter "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"iter"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        session.execute("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"            sa.select(User),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        ).scalars(),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    )"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"2-pep-681-지원"},"children":[{"type":"text","value":"2. PEP-681 지원"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"선언적 모델 정의가 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"dataclass"}]},{"type":"text","value":"에서 강하게 영감을 받은 만큼, 모델은 그 자체로 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"dataclass"}]},{"type":"text","value":"가 될 수 있습니다."}]},{"type":"element","tag":"code","props":{"code":"from __future__ import annotations\n\nfrom typing import Annotated\n\nimport sqlalchemy as sa\nfrom sqlalchemy.orm import (\n    DeclarativeBase,\n    Mapped,\n    MappedAsDataclass,\n    mapped_column,\n    relationship,\n)\n\nintpk = Annotated[int, mapped_column(primary_key=True)]\nstr30 = Annotated[str, mapped_column(sa.String(30))]\nuser_fk = Annotated[int, mapped_column(sa.ForeignKey(\"user_account.id\"))]\nengine = sa.create_engine(sa.make_url(\"sqlite://\"))\n\n\nclass Base(MappedAsDataclass, DeclarativeBase):\n    \"\"\"subclasses will be converted to dataclasses\"\"\"\n\n\nclass User(Base):\n    __tablename__ = \"user_account\"\n\n    id: Mapped[intpk] = mapped_column(init=False)\n    name: Mapped[str30]\n    fullname: Mapped[str | None] = mapped_column(default=None)\n    addresses: Mapped[list[Address]] = relationship(\n        back_populates=\"user\",\n        default_factory=list,\n    )\n\n\nclass Address(Base):\n    __tablename__ = \"address\"\n\n    id: Mapped[intpk] = mapped_column(init=False)\n    email_address: Mapped[str]\n    user_id: Mapped[user_fk] = mapped_column(init=False)\n    user: Mapped[User] = relationship(back_populates=\"addresses\", default=None)\n\n# # Address(id=None, email_address='email@address', user_id=None, user=None)\naddress = Address(email_address=\"email@address\")\n# User(\n#     id=None,\n#     name=\"username\",\n#     fullname=None,\n#     addresses=[\n#         Address(id=None, email_address=\"email@address\", user_id=None, user=...),\n#     ],\n# )\nuser = User(name=\"username\", addresses=[address])\n\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"__future__"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" annotations"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" typing "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" Annotated"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sqlalchemy "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sa"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sqlalchemy.orm "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" ("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    DeclarativeBase,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    Mapped,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    MappedAsDataclass,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    mapped_column,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    relationship,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"intpk "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" Annotated["}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", mapped_column("}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"primary_key"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"True"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":")]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"str30 "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" Annotated["}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", mapped_column(sa.String("}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"30"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"))]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"user_fk "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" Annotated["}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", mapped_column(sa.ForeignKey("}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"user_account.id\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"))]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"engine "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sa.create_engine(sa.make_url("}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"sqlite://\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"))"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"Base"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"MappedAsDataclass"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"DeclarativeBase"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"\"\"subclasses will be converted to dataclasses\"\"\""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"User"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"Base"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    __tablename__ "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"user_account\""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"id"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": Mapped[intpk] "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" mapped_column("}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"init"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"False"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    name: Mapped[str30]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    fullname: Mapped["}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"|"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" mapped_column("}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"default"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    addresses: Mapped[list[Address]] "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" relationship("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"back_populates"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"user\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"default_factory"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"list"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"Address"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"Base"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    __tablename__ "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"address\""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"id"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": Mapped[intpk] "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" mapped_column("}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"init"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"False"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    email_address: Mapped["}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    user_id: Mapped[user_fk] "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" mapped_column("}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"init"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"False"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    user: Mapped[User] "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" relationship("}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"back_populates"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"addresses\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"default"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"None"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# # Address(id=None, email_address='email@address', user_id=None, user=None)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"address "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" Address("}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"email_address"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"email@address\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# User("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"#     id=None,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"#     name=\"username\","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"#     fullname=None,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"#     addresses=["}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"#         Address(id=None, email_address=\"email@address\", user_id=None, user=...),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"#     ],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e938ec"},"children":[{"type":"text","value":"# )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"user "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" User("}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"username\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"addresses"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"[address])"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"3-최적화된-bulk-insertmysql-제외-mariadb-포함"},"children":[{"type":"text","value":"3. 최적화된 bulk insert("},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"MySQL"}]},{"type":"text","value":" 제외, "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"MariaDB"}]},{"type":"text","value":" 포함)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"RETURNING"}]},{"type":"text","value":"을 지원하는 모든 백엔드에 대한 성능 향상이 이뤄졌는데 그 차이가 상당히 극적입니다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"벤치마크는 다음 코드로 진행됐습니다."}]},{"type":"element","tag":"code","props":{"code":"@Profiler.profile\ndef test_flush_no_pk(n):\n    \"\"\"INSERT statements via the ORM (batched with RETURNING if available),\n    fetching generated row id\"\"\"\n    session = Session(bind=engine)\n    for chunk in range(0, n, 1000):\n        session.add_all(\n            [\n                Customer(\n                    name=\"customer name %d\" % i,\n                    description=\"customer description %d\" % i,\n                )\n                for i in range(chunk, chunk + 1000)\n            ]\n        )\n        session.flush()\n    session.commit()\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0fe791"},"children":[{"type":"text","value":"@Profiler.profile"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0fe791"},"children":[{"type":"text","value":"test_flush_no_pk"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"(n):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"\"\"INSERT statements via the ORM (batched with RETURNING if available),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"    fetching generated row id\"\"\""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    session "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" Session("}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"bind"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"engine)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" chunk "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"range"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", n, "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"1000"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"):"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        session.add_all("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"            ["}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"                Customer("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"                    "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"customer name "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"%d"}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" i,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"                    "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"description"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"customer description "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"%d"}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" i,"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"                )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"range"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"(chunk, chunk "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"1000"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"            ]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"        session.flush()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"    session.commit()"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"벤치마크 결과는 다음과 같습니다."}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"center"},"children":[{"type":"text","value":"driver"}]},{"type":"element","tag":"th","props":{"align":"center"},"children":[{"type":"text","value":"sqlalchemy1.4(초)"}]},{"type":"element","tag":"th","props":{"align":"center"},"children":[{"type":"text","value":"sqlalchemy2.0(초)"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"sqlite+pysqlite2 (memory)"}]},{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"6.204843"}]},{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"3.554856"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"postgresql+psycopg2 (network)"}]},{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"4.704876"}]},{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"4.699883"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"postgresql+asyncpg (network)"}]},{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"88.292285"}]},{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"4.561492"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"oracle+cx_Oracle (network)"}]},{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"92.603953"}]},{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"4.809520"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"mssql+pyodbc (network)"}]},{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"158.396667"}]},{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"4.825139"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"mariadb+mysqldb (network)"}]},{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"71.705197"}]},{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"4.075377"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"RETURNING"}]},{"type":"text","value":"을 지원하지 않는 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"MySQL"}]},{"type":"text","value":"과 2.0부터 지원하는 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"psycopg3"}]},{"type":"text","value":"의 벤치마크 결과는 다음과 같습니다."}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"center"},"children":[{"type":"text","value":"driver"}]},{"type":"element","tag":"th","props":{"align":"center"},"children":[{"type":"text","value":"sqlalchemy1.4(초)"}]},{"type":"element","tag":"th","props":{"align":"center"},"children":[{"type":"text","value":"sqlalchemy2.0(초)"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"postgresql+psycopg (network)"}]},{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"N/A (psycopg3)"}]},{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"4.861368"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"mysql+mysqldb (network)"}]},{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"77.281997"}]},{"type":"element","tag":"td","props":{"align":"center"},"children":[{"type":"text","value":"76.132995"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"4-향상된-orm-지원"},"children":[{"type":"text","value":"4. 향상된 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"orm"}]},{"type":"text","value":" 지원"}]},{"type":"element","tag":"h3","props":{"id":"bulk-insert"},"children":[{"type":"text","value":"bulk insert"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Insert.returning"}]},{"type":"text","value":"을 사용하거나 사용하지 않고 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Session.execute"}]},{"type":"text","value":"를 사용할 수 있습니다. 이는 기존의 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Session.bulk_insert_mappings"}]},{"type":"text","value":"와 동일합니다."}]},{"type":"element","tag":"code","props":{"code":">>> users = session.scalars(\n...     insert(User).returning(User),\n...     [\n...         {\"name\": \"spongebob\", \"fullname\": \"Spongebob Squarepants\"},\n...         {\"name\": \"sandy\", \"fullname\": \"Sandy Cheeks\"},\n...         {\"name\": \"patrick\", \"fullname\": \"Patrick Star\"},\n...         {\"name\": \"squidward\", \"fullname\": \"Squidward Tentacles\"},\n...         {\"name\": \"ehkrabs\", \"fullname\": \"Eugene H. Krabs\"},\n...     ],\n... )\n>>> print(users.all())\n[User(name='spongebob', fullname='Spongebob Squarepants'),\n User(name='sandy', fullname='Sandy Cheeks'),\n User(name='patrick', fullname='Patrick Star'),\n User(name='squidward', fullname='Squidward Tentacles'),\n User(name='ehkrabs', fullname='Eugene H. Krabs')]\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":">>>"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" users "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" session.scalars("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"     insert(User).returning(User),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"     ["}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"         {"}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"name\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"spongebob\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"fullname\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"Spongebob Squarepants\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"},"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"         {"}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"name\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"sandy\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"fullname\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"Sandy Cheeks\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"},"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"         {"}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"name\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"patrick\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"fullname\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"Patrick Star\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"},"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"         {"}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"name\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"squidward\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"fullname\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"Squidward Tentacles\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"},"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"         {"}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"name\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"ehkrabs\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"fullname\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"Eugene H. Krabs\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"},"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"     ],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" )"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":">>>"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"print"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"(users.all())"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"[User("}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"'spongebob'"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"fullname"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"'Spongebob Squarepants'"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" User("}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"'sandy'"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"fullname"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"'Sandy Cheeks'"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" User("}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"'patrick'"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"fullname"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"'Patrick Star'"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" User("}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"'squidward'"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"fullname"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"'Squidward Tentacles'"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" User("}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"'ehkrabs'"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-80a864"},"children":[{"type":"text","value":"fullname"}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"'Eugene H. Krabs'"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":")]"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"bulk-update"},"children":[{"type":"text","value":"bulk update"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Insert"}]},{"type":"text","value":"와 같은 방법으로 사용가능합니다. 기존의 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Session.bulk_update_mappings"}]},{"type":"text","value":"와 동일합니다. 단 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"returning"}]},{"type":"text","value":"은 지원하지 않습니다."}]},{"type":"element","tag":"code","props":{"code":">>> from sqlalchemy import update\n>>> session.execute(\n...     update(User),\n...     [\n...         {\"id\": 1, \"fullname\": \"Spongebob Squarepants\"},\n...         {\"id\": 3, \"fullname\": \"Patrick Star\"},\n...     ],\n... )\n","language":"python","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":">>>"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" sqlalchemy "}]},{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" update"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1152f9"},"children":[{"type":"text","value":">>>"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" session.execute("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"     update(User),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"     ["}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"         {"}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"id\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"fullname\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"Spongebob Squarepants\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"},"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"         {"}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"id\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"3"}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"fullname\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"class":"ct-4edeb9"},"children":[{"type":"text","value":"\"Patrick Star\""}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"},"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":"     ],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-06b4ef"},"children":[{"type":"text","value":"..."}]},{"type":"element","tag":"span","props":{"class":"ct-fefd64"},"children":[{"type":"text","value":" )"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"synchronize_session"},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"synchronize_session"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"synchronize_session"}]},{"type":"text","value":"의 기본값이 새로 추가된 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"auto"}]},{"type":"text","value":"로 변경됐습니다. "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"auto"}]},{"type":"text","value":"는 우선 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"evaluate"}]},{"type":"text","value":"로 시도하고, 문제가 발생하면 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":"로 다시 시도합니다. "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"MySQL"}]},{"type":"text","value":"과 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"MariaDB"}]},{"type":"text","value":"를 제외한 모든 백엔드에서 효율적입니다."}]},{"type":"element","tag":"h2","props":{"id":"5-그-외"},"children":[{"type":"text","value":"5. 그 외.."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"그 외에도 여러가지 변경 및 추가사항이 많습니다. 하지만 굳이 다 적을 필요가 없기에 생략합니다.\n원문 링크는 본문 상단에 있습니다."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"sqlalchemy2.0"}]},{"type":"text","value":"은, 기존에 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"sqlalchemy"}]},{"type":"text","value":"를 사용했다면, 사용하지 않을 이유가 없는 라이브러리입니다. 하지만 아쉽게도 아직 다른 라이브러리와 종속성 문제로 인해 사용하지 못하는 경우가 많겠습니다. "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"airflow"}]},{"type":"text","value":"라던가 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"pandas"}]},{"type":"text","value":"("},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"read_sql"}]},{"type":"text","value":"이나 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"to_sql"}]},{"type":"text","value":"같은 메소드를 사용하지 않으면 상관없습니다)같은 경우입니다."}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-0fe791{color:#8250DF}\n.ct-80a864{color:#953800}\n.ct-06b4ef{color:#0550AE}\n.ct-e938ec{color:#6E7781}\n.ct-4edeb9{color:#0A3069}\n.ct-fefd64{color:#24292F}\n.ct-1152f9{color:#CF222E}\n.dark .ct-1152f9{color:#FF7B72}\n.dark .ct-fefd64{color:#C9D1D9}\n.dark .ct-4edeb9{color:#A5D6FF}\n.dark .ct-e938ec{color:#8B949E}\n.dark .ct-06b4ef{color:#79C0FF}\n.dark .ct-80a864{color:#FFA657}\n.dark .ct-0fe791{color:#D2A8FF}"}]}],"toc":{"title":"","searchDepth":5,"depth":5,"links":[{"id":"1-pep-484-지원","depth":2,"text":"1. PEP-484 지원"},{"id":"2-pep-681-지원","depth":2,"text":"2. PEP-681 지원"},{"id":"3-최적화된-bulk-insertmysql-제외-mariadb-포함","depth":2,"text":"3. 최적화된 bulk insert(MySQL 제외, MariaDB 포함)"},{"id":"4-향상된-orm-지원","depth":2,"text":"4. 향상된 orm 지원","children":[{"id":"bulk-insert","depth":3,"text":"bulk insert"},{"id":"bulk-update","depth":3,"text":"bulk update"},{"id":"synchronize_session","depth":3,"text":"synchronize_session"}]},{"id":"5-그-외","depth":2,"text":"5. 그 외.."}]}},"_type":"markdown","_id":"content:python:why_sqlachemy2.md","_source":"content","_file":"python/why_sqlachemy2.md","_extension":"md"}